% -*- tex-open-quote: "\""; tex-close-quote: "\""; tex-command-list: (("xdvi" "~/bin/latexgrep" "") ("pdfprint" "~/bin/pdflatexgrep" "")); save-place: t -*-
% is pdfminorversion=7 really needed??
% is pdfminorversion=7 really needed??
% is pdfminorversion=7 really needed??
% is pdfminorversion=7 really needed??
% is pdfminorversion=7 really needed??

%%%%% mention fn-Delete on MacOS
%%%%% mention fn-Delete on MacOS
%%%%% mention fn-Delete on MacOS
%%%%% mention fn-Delete on MacOS

%%%% Exercise 19 on construction geometry: how can 2 construction lines be
%%%% omitted? -> equality in the right upper corner of inner and outer lines


% use icons from ArtWork page:
%   - download
%   - open in inkscape, "Kopie speichern" pdf
%   (- convert name.pdf name.eps)
%   - convLast (ohne Parameter) f"uhrt den convert-Schritt mit der letzten
%     pdf/png-Datei aus
%   - falls nicht in adobe zu "offnen (vgl. https://en.wikibooks.org/wiki/LaTeX/Importing_Graphics):
%     convert -alpha off input.png output.png

% use screenshot:
%   - make screenshot
%   - cd images directory
%   - scs name  (for system screenshots)  or
%   - scs2 name (for FC Snip screenshots)
%     this creates name.png and name.eps in the current directory if there is no
%     other screenshot in tmp

% to do:
% selection of elements with box, see https://forum.freecadweb.org/viewtopic.php?f=3&t=29595&p=259199#p259199
% non intersecting sketch (Normand): https://forum.freecadweb.org/viewtopic.php?t=8805#p72550
\documentclass[12pt,titlepage]{article}
\pdfminorversion=7
\usepackage[utf8]{inputenc} % Включаем поддержку UTF8
\usepackage[T1,T2A]{fontenc}
\usepackage[russian]{babel}
\usepackage{geometry}\geometry{left=2.5cm,right=2.5cm,top=2cm,bottom=2cm}
\usepackage{enumerate}
\usepackage{color}
\usepackage[export]{adjustbox}
\usepackage{graphicx}
\usepackage[russian]{varioref} % set to \usepackage[spanish/german/french/...]{varioref}
\usepackage{srcltx}
\usepackage[bookmarksnumbered=true,breaklinks]{hyperref}
\usepackage[percent]{overpic}

\definecolor{darkGreen}{rgb}{0,0.45,0}

\unitlength1mm
\newcommand{\degree}{\ensuremath{^\circ}}
\newcommand{\menu}{\mbox{$\rightarrow$}}
\newcommand{\icon}[1]{\raisebox{-1em}{\rule{0pt}{27pt}\includegraphics[height=2.2em]{images/#1}}}
\newcommand{\iconMedium}[1]{\raisebox{-2ex}{\rule{0pt}{23pt}\includegraphics[height=4ex]{images/#1}}}
\newcommand{\iconSmall}[1]{\raisebox{-2ex}{\includegraphics[height=3ex]{images/#1}}}
\newcommand{\img}[2]{\vspace{2ex}\noindent\includegraphics[#1]{images/#2}}
\newcommand{\imgTop}[2]{\raisebox{0ex}{\includegraphics[valign=t,#1]{images/#2}}}
\newcommand{\imgFull}[1]{\vspace{2ex}\noindent\includegraphics[width=\textwidth]{images/#1}}
\newcommand{\dofConsumed}{Number of DOF consumed:}
\newcommand{\dofAdded}{Количество добавленных степеней свободы:}

\newtheorem{Exercise}{Упражнение}
\parindent0pt
\parskip1ex plus 0.5ex minus4pt


  \newcount\hours
  \newcount\minutes
  \def\SetTime{\hours=\time
          \global\divide\hours by 60
          \minutes=\hours
          \multiply\minutes by 60
          \advance\minutes by-\time
          \global\multiply\minutes by-1 }
  \SetTime
  \def\now{\number\hours:\ifnum\minutes<10 0\fi\number\minutes}

\title{Лекция по верстаку Sketcher}
\author{Кристоф Блауэ\\
\\
\scriptsize с особой благодарностью участникам \href {https://forum.freecadweb.org} {форума FreeCAD}:\\
\small bejant,
TheMarkster,
openBrain,
MSOlsen65
}
%\date{\today{}, \now}

\let\partOrigin\part
\renewcommand\part{\newpage\partOrigin}

\newcommand{\currentVersion}{0.19.21007}

\begin{document}
\maketitle
\setcounter{page}{2}

\tableofcontents
\newpage

\subsection*{Введение}
{\em Эта лекция написана для FreeCAD 0.19. Все было протестировано с
\currentVersion{} или новее. Некоторые описанные здесь вещи могут быть не доступны или 
выглядеть иначе в других версиях FreeCAD}.
\vspace{2.5em}

Эскизы служат основными элементами в большинстве объектов PartDesign, и они часто
также используется в верстаке Part. В этой лекции я покажу, как создать
эскиз и как обращаться с разными геометрическими элементами и разными
ограничения.

Перед изучением этой лекции, вы должны уметь создавать документ FreeCAD, иметь понятие о верстаках (Workbench) и уметь их сменить.  Вы должны знать, что такое 3D-вид, и иметь базовые знания об организации тела PartDesign.

\part{Базовые понятия}

\section{Создание эскиза}
Есть две возможности создать эскиз. Оба похожи, но не идентичны.

\subsection{Создание эскиза в верстаке Sketcher}
В верстаке Sketcher вы можете создать эскиз из меню: Sketcher\menu Создать эскиз, но вы, вероятно, предпочтете использовать значок \icon{Sketcher_NewSketch}. В зависимости от этого будут происходить разные вещи.

\begin{itemize}
\itemЕсли ничего не было выбрано, вас спросят об ориентации эскиза:

\img{scale=0.8}{Orientation}

С помощью радиокнопки вы можете управлять плоскостью, в которой вы хотите создать эскиз. Отметка «Развернуть направление» прикрепит эскиз к обратной стороне выбранной плоскости, по аналогии с  рисунком на обратной стороне листа бумаги. «Смещение» перемещает эскиз в направлении, перпендикулярном выбранной плоскости.

\item Если вы выбрали плоскую грань, эскиз прикрепляется к этой грани, то есть это похоже на рисование на этой грани.

\item Если вам нужны более сложные варианты размещения, смотрите раздел       \ref{SketchPlacement}.
\end{itemize}
После нажатия кнопки OK мы переходим в режим редактирования Sketcher, иными словами мы «входим в Sketcher».


\subsection{Создание эскиза в верстаке PartDesign}
В верстаке PartDesign у вас есть такой же значок \icon{Sketcher_NewSketch}, но так как в PartDesign все происходит внутри тела, когда вы щелкаете его здесь, могут произойти следующие вещи:

\begin{itemize}
\item Если в вашем документе нет тела, оно создается, активируется и внутри его создается новый эскиз.
\item Если в вашем документе только одно тело, оно активируется и внутри его создается новый эскиз.
\item Если существует активное тело, внутри него  создается новый эскиз. Это не зависит от количества тел в документе.
\item Если существует более одного тела и ни одно из них не активно, отображается сообщение об ошибке с просьбой активировать тело.
\end{itemize}
Также, в зависимости от ранее сделанного выбора может произойти следующее:

\begin{itemize}
\item Если ничего не выбрано, открывается новая панель, и вы должны выбрать ориентацию нового эскиза либо на панели, либо в трехмерном виде справа, выбрав одну из главных плоскостей. На изображении предварительно выбрана плоскость XZ:

\img{width=0.45\textwidth}{Origin}

На раннем этапе оставьте все флажки снятыми и нажмите ОК.
\item Если выбрана грань или плоскость внутри активного или единственного тела, новый эскиз прикрепляется к этой грани, то есть это похоже на рисование на этой грани. 
\item Если выбрана грань за пределами активного (или единственного) тела, возникает вопрос, как связать грань.

      Я не рекомендую такой метод. Я предпочитаю создавать ShapeBinder вручную, чтобы лучше контролировать включенные грани.
      \begin{itemize}
      \item Параметр «Создать независимую копию» создает несвязанный объект ShapeBinder, к которому прикреплен эскиз.
      \item Параметр «Сделать зависимую копию» создает связанный объект ShapeBinder, к которому прикрепляется эскиз. Изменения базового объекта повлекут изменения ShapeBinder.
      \item Параметр «Создать перекрестную ссылку» создает запрещенную ссылку (сообщение: {\em Ссылки выходят за пределы разрешенной области}).

            Я вообще не рекомендую использовать эту опцию.
      \end{itemize}
\end{itemize}

Теперь вы входите в Sketcher.

\section{Окно Sketcher}
\vbox{
Мы не будем использовать все виджеты в окне эскиза, но краткий обзор используемых виджетов, надеюсь, поможет прояснить то, о чем я буду говорить позже.
\vspace{2ex}

{\large%
%begin{overpic}[width=\textwidth,grid,tics=10]{images/SketcherWindow}
\begin{overpic}[width=0.999\textwidth]{images/SketcherWindow}
\put(35,90){Геометрические элементы}
\put(34.2,91.25){\vector(-1,1){2.1}}

\put(68,87){Ограничения}
\put(72,90){\vector(-1,4){1}}

\put(34,79){Сообщения решателя}
\put(33,80){\vector(-4,1){5}}

\put(34,69){Редактировать элементы управления}
\put(33,70){\vector(-1,0){5}}

\put(34,34){Список ограничений}
\put(33,35){\vector(-1,0){5}}

\put(34,11){Список элементов}
\put(33,12){\vector(-1,0){5}}

\put(60,25){\Large 3D вид}

\put(7,-7){Панель Sketcher}
\put(10,-4){\vector(0,1){3}}
\end{overpic}%
\vspace{6ex}
}
}

\begin{description}

\item [3D вид.] Эскизы редактируются в 3D виде. Тем не менее, эскизы строго 2D.
\item [Панель эскиза.] С левой стороны вы видите панель эскиза в Комбо панели. При необходимости вы можете переключить представление в виде дерева и обратно.
      
      На панели есть различные области (или «виджеты»), управляющие и отображающие дополнительную информацию о эскизе. Вы можете свернуть или развернуть сообщения решателя, редактировать элементы управления, ограничения и элементы.
\item [Кнопка «Закрыть».] Расположенная вверху, завершает сеанс редактирования эскиза.
\item [Сообщения решателя.] Под кнопкой закрытия вы видите сообщения решателя, показывающие «Пустой эскиз», пока вы не добавите элементы в свой эскиз.
      
      Область Сообщения решателя очень важна, и я советую \emph {не} сворачивать ее. Вместо этого обращайте на неё  постоянное внимание.
\item [Сетка.] \label{GridSnap} А пока откройте «Редактировать элементы управления» и снимите флажок «Показать сетку». Хотя сетка может быть полезна при размещении геометрических элементов, важно знать следующее:
      \begin {itemize}
      \item В Sketcher геометрические элементы, размещенные на пересечениях сетки, никогда не прикрепляются к сетке; они могут уйти от пересечений сетки, если применяются ограничения.
      \item Отдельные части геометрии, которые имеют общую точку в одном месте привязки сетки, не прикреплены друг к другу, и они могут неожиданно раздвинуться, пока между этими общими точками не будет применено ограничение.
      \end {itemize}

      Если у вас включена привязка к сетке, может {\em казаться}, что точки привязки имеют свои позиции, уже определенные пересечением сетки, хотя на самом деле они могут свободно перемещаться. Поэтому я предпочитаю выключить ее, чтобы избежать путаницы.

\item [Список ограничений.] Это будет обсуждаться позже в этом разделе. Оставьте флажки как есть, т.е.  для Фильтра установлено значение «Все», флажок «Скрыть внутреннее выравнивание» установлен, флажок «Расширенная информация» снят.
\item [Список Элементов.] Это также будет обсуждаться позже в этом разделе.
\item [Инструменты геометрии эскиза.] Они используются для создания точек, линий, дуг и других геометрических фигур. Вы получите такой же список, что и в контекстном меню, если щелкнете правой кнопкой мыши в пустом месте в 3D-виде:

\hspace*{-\leftmargini}\img{width=\textwidth}{GeomElements}

\item [Инструменты ограничения эскиза.] Они - грубо говоря - используются для определения положения геометрических элементов и их взаимоотношений:

\hspace*{-\leftmargini}\img{width=\textwidth}{Constraints}
\end{description}

\section{Общие замечания о степенях свободы}
В эскизе есть определенные геометрические элементы, такие как линии и дуги, которые имеют определенное положения на плоскости 2D-эскиза. Эти положение определяется размерами или соотношением к другим точкам, линиям или дугам. Количество возможностей перемещения элементов - это количество степеней свободы, сокращенно «КСС».

Вы можете думать об этом как о том, сколько измерений x и y вам нужно, чтобы зафиксировать каждую точку, будь то просто одиночная точка или точка в конце линии или дуги.

\pagebreak[3]
\begin{Exercise}
Создайте диагональную линию, где ни одна из конечных точек не лежит на оси X или Y.
\end{Exercise}

Сделайте так
\begin{itemize}
\item Щелкните значок CreateLine \icon{Sketcher_CreateLine}. Теперь вы видите рядом с курсором небольшой символ красной линии.
\item Щелкните в том месте, где вы хотите разместить первую точку.
\item Переместите мышь.
\item Щелкните в том месте, где вы хотите разместить вторую точку.
\item Щелкните правой кнопкой мыши, чтобы выйти из режима создания линии. Это поведение можно настроить в Настройки \menu Эскизирование \menu Основные \menu Создание геометрии "Режим Продолжения".
\end{itemize}

Теперь сообщения решателя и 3D изображение должны выглядеть так:

\img{scale=0.9}{Exercise1}

Справа вы видите линию в трехмерном представлении, слева вы видите сообщения решателя, информирующее вас, что у вас есть \emph {4 степени свободы}.

\imgTop{scale=1}{ElementsLine}
\hspace{1em}
\parbox[t]{0.34\textwidth}{
Хотя список ограничений на панели все еще пуст, список элементов \label{ListOfElements1} показывает линию, которую мы только что создали. Если вы наведете указатель мыши на элемент, он будет выделен (станет желтым) в 3D-виде.
}

\begin{Exercise}
\label{ExerciseHorizontalDistance}
Добавьте ограничение горизонтального расстояния в левую нижнюю точку.
\end{Exercise}

Сделайте так
\begin{itemize}
\item Наведите указатель мыши на нижнюю левую точку, пока она не станет желтой. Теперь она предварительно выбрана, то есть вы \emph{можем} его выбрать.
\item Щелкните левой кнопкой мыши, чтобы выбрать точку, она станет темно-зеленой.
\item Щелкните значок ограничения расстояния по горизонтали \icon{Constraint_HorizontalDistance}. Это создает ограничение между исходной точкой и выбранной точкой. Предлагаемое значение - это текущее расстояние.
\item Введите значение, которое хотите получить, и подтвердите. В моем случае текущее значение было 24, которое я собираюсь изменить на 25\,мм.

      \img{width=0.92\textwidth}{Horizontal}
\item Подтвердите, нажав ОК.
\end{itemize}

Глядя на сообщения решателя, вы видите, что КСС изменилась с 4 на 3:

\img{}{Dof1}

Список элементов по-прежнему содержит линию и не изменяется. Список ограничений теперь содержит один элемент, новое ограничение:

\img{}{Constraints1}

\begin{Exercise}
\label{ExerciseVerticalDistance}
Добавьте ограничение вертикального размера 30\,мм в левую нижнюю точку.
\end{Exercise}

Для этого выполняете те же шаги, что и с горизонтальным ограничением, но теперь используете значок ограничения вертикального расстояния \icon {Constraint_VerticalDistance}.

Вы можете видеть, что, применив другое ограничение, вы уменьшили КСС до 2.

Эти простые ограничения уменьшают количество степеней свободы на единицу, но есть более сложные ограничения, которые уменьшают КСС на 2 или даже 3. В качестве примера давайте выполним еще одно упражнение.

\begin{Exercise}
\label{ExerciseCoincidence}
Добавьте ограничение совпадения между правым верхним концом линии и началом координат.
\end{Exercise}

Сделайте так
\begin{itemize}
\item Выберите правую верхнюю конечную точку, как вы делали с другой точкой раньше, она станет темно-зеленой.
\item Выберите начало координат. Вы можете сделать это, просто щелкнув, как и раньше, без удерживания дополнительных клавиш. Мы называем это «greedy selection».
\item Щелкните значок ограничения совпадения \icon {Constraint_PointOnPoint}.
\end{itemize}

Теперь произошло три вещи:
\begin{itemize}
\item Правая верхняя точка переместилась в начало координат.
\item Решающая программа сообщает "Эскиз не содержит степеней свободы". Это хорошо; вы всегда должны полностью ограничивать свои эскизы. Из этого правила очень мало исключений.
\item Цвет эскиза изменился с белого на светло-зеленый.
\end{itemize}

Вот как это выглядит сейчас:

\img{width=8cm}{Fully1}

\label{ListOfElements2}Список элементов по-прежнему содержит линию, список ограничений теперь содержит три записи:

\img{}{Constraints2}

\section{Автоматические ограничения}
Если автоматические ограничения включены, некоторые ограничения создаются автоматически. Чтобы увидеть разницу между включеными и выключеными автоматическими ограничениями, давайте их включим.

\subsection{Автоматические ограничения включены}

\begin{Exercise}
Разверните раздел «Редактировать элементы управления» на панели и убедитесь, что установлен флажок «Автоматические ограничения», который установлен по умолчанию. Оставьте также отмеченным "Избегать избыточных автоматических ограничений".

\img{width=0.56\textwidth}{AutoConstraintsOn}
\end{Exercise}

Теперь создайте еще одну линию следующим образом:
\begin{itemize}
\item Щелкните значок CreateLine \icon{Sketcher_CreateLine}
\item Наведите указатель мыши на правую верхнюю точку существующей линии. Точка становится желтой (ее трудно увидеть из-за красных ограничительных линий), и кроме символа линии рядом с курсором появляется дополнительная точка.

\img{}{Auto1}
\item Щелкните левой кнопкой мыши
\item Переместите курсор по горизонтали вправо
\ tem Под линией появляется красный маркер, указывающий на возможность применения горизонтального ограничения.

\img{}{Auto2}
\item Щелкните, чтобы создать линию.
\end{itemize}

Эскиз снова стал белым, потому что он больше не ограничен полностью, а над горизонтальной линией вы видите небольшую горизонтальную красную линию, указывающую, что эта линия имеет горизонтальное ограничение.

\label{auto3}
\img{}{Auto3}

\begin{itemize}
\item Решатель сообщает, что осталась 1 степень свободы.
\item Список элементов теперь состоит из двух линий. Наведите указатель мыши на записи списка и посмотрите, как соответствующие элементы станут желтыми в 3D виде.
\item В списке ограничений отображается 5 ограничений, два последних были созданы автоматически.

\img{}{ListConstraintsAuto}
\end{itemize}

\subsection{Автоматические ограничения отключены}
\vbox{
Удалите горизонтальную линию, эскиз снова станет зеленым.

Откройте раздел Правка элементов управления и отключите автоматические ограничения.

\img{scale=0.9}{AutoConstraintsOff}
}

\begin{Exercise}
Создайте горизонтальную линию так же, как и при включенных автоматических ограничениях.
\end{Exercise}

Результат выглядит почти так же, единственное отличие в 3D-виде - отсутствие индикатора горизонтального ограничения. Разница проявляется в КСС, списке ограничений и, конечно же, в поведении:

\begin{itemize}
\item Решатель сообщает о 4х степенях свободы.
\item Список ограничений идентичен состоянию только с одной линией.
\item Возьмите одну из конечных точек и перемещайте ее вверх и вниз. Другая точка сохранит свое положение по горизонтали и вертикали.
\end{itemize}

Вы можете добавить ограничения вручную, что приведет к тому же эскизу, который был у нас с включенными автоматическими ограничениями.

{\bf Предупреждение:} Перед тем как продолжить,  снова включите автоматические ограничения.


%\vspace{3ex}
{\bf Общие правила:} Теперь вы знаете основы работы со Sketcher и должны были изучить следующие 
{\em\begin{itemize}
\item Добавление геометрического элемента увеличивает количество степеней свободы.
\item Добавление ограничения уменьшает количество степеней свободы.
\end{itemize}
}

\newpage

\part{Геометрические элементы}
В этой части вы узнаете о геометрических элементах. В некоторых упражнениях используются автоматические ограничения, поэтому еще раз убедитесь, что они включены.

В части использования геометрических элементов я буду использовать некоторые ограничения, которые еще не объяснены, поэтому вам, возможно, придется дважды проработать этот раздел, чтобы полностью понять его. Лучшего решения проблемы, с чего начать, не было. Чтобы объяснить использование геометрических элементов, мне нужны некоторые ограничения, а для объяснения ограничений мне, конечно же, нужны геометрические элементы. При использовании ограничений в части, посвященной геометрическим элементам, я ограничиваю объяснения ограничений до минимума. Их дальнейшее использование будет объяснено позже в части \vref{Constraints}.

Для получения дополнительной информации см.
\href {https://www.freecadweb.org/wiki/Sketcher_Workbench} {документацию}, доступную в Интернете.

\section{Обычное использование}
Когда вы выбираете один из инструментов создания геометрических элементов, таких как линия, окружность, дуга, ... вы входите в режим создания для произвольного количества этих объектов. Когда вы входите в режим создания, курсор в 3D-виде превращается в крестик и дополняется информацией о его текущих координатах x / y и отображением символа, указывающего, какой тип геометрического объекта вы собираетесь создать. Примеры для линии, дуги и паза:

\img{width=0.3\textwidth}{CursorLine}\hfill
\img{width=0.3\textwidth}{CursorArc}\hfill
\img{width=0.3\textwidth}{CursorSlot}

Когда вы создали один из геометрических элементов, вы все еще находитесь в режиме создания, поэтому вы можете немедленно продолжить создание следующего объекта. Это поведение можно настроить в Настройки\menu Эскиз \menu Общие \menu Создание геометрии "Непрерывный режим (Continue Mode)". Если вы снимите этот флажок в настройках, режим создания завершится сразу после создания элемента.

Чтобы выйти из режима создания, вы можете щелкнуть правой кнопкой мыши или нажать клавишу ESC. Последнее иногда является проблемой, потому что, если вы не находитесь в режиме создания, клавиша ESC завершает редактирование эскиза и закрывает Sketcher; таким образом, дважды нажав ESC, вы выйдете из режима создания и завершите редактирование. Создание полилинии немного отличается, так как вам понадобится дополнительный щелчок правой кнопкой мыши или нажатие клавиши ESC, чтобы выйти из непрерывного режима.

Я рекомендую использовать щелчок правой кнопкой, потому что у вас все равно есть рука на мыши, и нет опасности непреднамеренно покинуть Sketcher частым нажатием клавиши ESC.

Вы можете настроить поведение выхода по клавише ESC в настройках Sketcher.

\section{Линия}
\begin{tabular}{|l|l|}
\hline
Иконка: & \icon{Sketcher_CreateLine}\\
\hline
\dofAdded & 4\\
\hline
\end{tabular}

Линия определяется конечными точками, каждая конечная точка добавляет 2 степени свободы, что в сумме составляет до 4 степеней свободы.

\subsection*{Типичные ограничения}
\begin{description}
\item [Совпадение конечных точек] В упражнении \vref {ExerciseCoincidence} мы уже использовали это.
\item [Горизонтальное ограничение] для горизонтальной линии. Выберите линию и щелкните значок  ограничения горизонтальности \icon {Constraint_Horizontal}
      
      Линия станет и останется строго горизонтальной.
\item [Вертикальное ограничение] для вертикальных линий. Выберите линию и щелкните значок ограничения вертикальности \icon {Constraint_Vertical}

      Линия станет и останется строго вертикальной.
\item [Equality] Выберите две линии и щелкните значок \icon{Constraint_EqualLength}

      \img{scale=0.8}{LineEquality}
      
      Линии станут и останутся равными по длине.
\typeout{без учета ориентации линий}
\item[Расстояние по горизонтали] Выберите линию и щелкните значок \icon {Constraint_HorizontalDistance}. Введите расстояние в поле ввода, как в упражнении \vref{ExerciseHorizontalDistance}

      Обычно это применяется к горизонтальным линиям, но не ограничивается ими.
%\hspace*{0em}\vbox{}
      Если вы примените его к наклонной линии, это ограничение определяет расстояние по горизонтали между конечными точками.

      \img{scale=0.8}{LineHorizontalDistance}
\item [Расстояние по вертикали] Выберите линию и щелкните значок \icon {Constraint_VerticalDistance}. Введите расстояние в поле ввода, как в упражнении \vref{ExerciseVerticalDistance}

Обычно это применяется к вертикальным линиям, но не ограничивается ими. Если вы примените его к наклонной линии, это ограничение определяет расстояние по вертикали между конечными точками.

      \img{scale=0.8}{LineVerticalDistance}

\item [Длина] \label {LineLength} Выберите линию и щелкните значок \icon {Constraint_Length}. Введите значение, аналогично как для горизонтального или вертикального расстояния.
      
      \img{scale=0.8}{LineLength}

{\bf Предупреждение:} Не используйте это ограничение для горизонтальных или вертикальных линий --- если вы не собираетесь изменять угол элемента в Sketcher позже (например, рассмотрите возможность поворота паза, как в разделе  \vref {SlotTilted}).
      Вместо этого используйте специальные ограничения по горизонтали или по вертикали. Это упрощает работу решателя; подробности смотрите в разделе \vref {SolverRecommendations}.
\end{description}

Следует отметить, что то, что мы называем линией, на самом деле является только отрезком линии. Этот отрезок лежит на линии бесконечной длины. Это важно, когда задействованы ограничения точки на объекте или касания (см. Разделы \ref {PointOnObject} на странице \pageref {PointOnObject} и раздел \ref {Tangency} на странице \pageref {Tangency}).

\vbox{
\begin{Exercise}
\label{exerciseLinesPerpendicular}
Создайте следующий эскиз. У него только одно ограничение длины, и все короткие линии равны. Кроме того, в эскизе есть только ограничения совпадения, вертикальности, горизонтальности и равенства.
\end{Exercise}
В показанном здесь состоянии он имеет 1 степень свободы:

\img{scale=0.8}{Line1}
}

Цель: две выбранные линии должны находиться на одном уровне. Это может быть достигнуто, например, путем выбора линии слева и точки справа и применения ограничения «точка на объекте».

\img{width=0.47\textwidth}{Line2}
\hfill
\raisebox{2cm}{$\stackrel{\img{width=1.4em}{Constraint_PointOnObject}}{\longrightarrow}$}
\hfill
\img{width=0.47\textwidth}{Line3}

\section{Окружность}
\begin{tabular}{|l|l|}
\hline
Иконки: & \icon{Sketcher_CreateCircle} (default)\\
       & \icon{Sketcher_Create3PointCircle}\\
\hline
\dofAdded & 3\\
\hline
\end{tabular}

Окружность может быть определена положением его центра с 2 степенями свободы и радиусом с одной степенью свободы, что в сумме составляет до 3 степеней свободы.

Есть два варианта создания окружностей. Как только окружность создана, нет никакой разницы между двумя методами.
\begin{enumerate}
\item В методе по умолчанию создание окружности начинается с центра, а затем добавляется радиус: После нажатия \icon {Sketcher_CreateCircle} щелкните в трехмерном виде в том месте, где вы хотите разместить центр окружности. Переместите мышь и наблюдайте, как радиус увеличивается вместе с положением мыши. Щелкните точку, которая затем будет лежать на окружности.
      
      Если у вас включены автоматические ограничения, вы можете выбрать существующую точку щелчком мыши, что создаст ограничение точки на объекте.
\item Чтобы выбрать альтернативный режим создания, щелкните маленький треугольник справа от значка создания окружности и выберите \icon {Sketcher_Create3PointCircle}. Теперь вы можете щелкнуть по трем точкам в 3D-виде, которые будут лежать на окружности. Такой режим создания  будет по умолчанию до завершения  вашего сеанса FreeCAD, пока вы снова не поменяете его.
\end{enumerate}


\subsection*{Типичные ограничения}
\begin{description}
\item [Позиционирование центра] может быть достигнуто любым методом, используемым для позиционирования точки, включая совпадение, горизонтальное и вертикальное расстояние. 
\item [Радиус / Диаметр] Выберите окружность и примените ограничение радиуса \icon {Constraint_Radius}.
      
       Если вы хотите использовать диаметр, выберите в раскрывающемся меню значок диаметра \icon {Constraint_Diameter}. Диаметр часто используется для окружностей, а радиус - для дуг.
\item [Равенство] Выберите две окружности или окружность и дугу и щелкните значок \icon {Constraint_EqualLength}

      \img{}{EqualCircle}

	Радиусы каждой окружности станут и останутся равными друг другу.

Обратите внимание, что равенство между окружностью и линией невозможно, если вы только не используете так называемые \emph {Выражения}. Данная тема  выходит за рамки лекции; см. также замечание о длине дуги на странице \pageref {arclength}.

{\footnotesize Замечание по математике: вычисление длины окружности было одной из самых важных задач математики с древних времен. В настоящее время доказано, что эта проблема не решается с конечной точностью.}
\ item [Точка на Объекте] Если вы хотите зафиксировать точку на окружности, например конечную точку линии, вы можете выбрать окуржность и конечную точку и применить ограничение «точка на объекте», щелкнув \icon {Constraint_PointOnObject}.

      \img{}{PointOnCircle}

   Обратите внимание, что эскиз в том виде, в котором он показан здесь, нельзя ни выдавить, ни создать вырез по двум причинам: эскиз не является замкнутой формой, и в нем есть соединение трех линий в одной точке. Мы называем эту ситуацию \emph {самопересечением}.

\item [Касание] Обычно есть две возможности создать касание на окружности. Поэтому вам следует переместить все задействованные окружности, линии или дуги как можно ближе к их соответствующим конечным положениям, \emph {до того, как} вы примените ограничение касания.

Касание может быть применено к окружности двумя разными способами.
      \begin{itemize}
\item Конечная точка прямой или дуги может лежать на окружности. Затем выберите окружность и конечную точку и примените ограничение касания \icon {Constraint_Tangent}.

             \img {} {TangencyCirclePoint}
            
             Я должен еще раз упомянуть, что этот пример нельзя  ни выдавить, ни создать вырез из-за самопересечения и отсутствия замкнутой формы.
       \item Окружность касается другой окружности, дуги или линии. Выберите окружность и линию или дугу --- Обратите внимание на отличие от прелыдущего способа; не выбирайте точку! --- и примените касание с помощью \icon {Constraint_Tangent}.
            
             В этом примере я сделал это дважды, один раз по оси X и один раз по оси Y:
            
             \img {scale = 0.9} {TangencyCircleLine}

             Такого рода касание можно  применить даже между линией и окружностью, которые не касаятся друг друга:

            \img{}{CircleTangentNoTouch}
      \end{itemize}
\end{description}

\pagebreak

Окружности часто используются для создания отверстий либо с помощью вырезов, либо с помощью специального инструмента создания отверстий. Хотя последний не использует значение радиуса, вы, тем не менее, должны полностью ограничить свои эскизы.

\vbox{
\begin{Exercise}
\label{ExerciseConstruction}
Выберите верстак PartDesign и создайте эскиз фланца:

\imgFull{FlangeSquare}
\end{Exercise}
}

Чтобы центрировать квадраты, мы используем ограничение симметрии: выберите левый нижний угол и правый верхний угол, а затем центр. Потом примените ограничение симметрии \icon {Constraint_Symmetric}.

Фланец в таком виде нельзя выдавить так, как между внутренним квадратом и маленькими отверстиями есть пересечения. В любом случае внутренний квадрат для выдавливания нам не нужен, он нужен только для построения эскиза. Давайте заменим внутренний квадрат на конструкционные линии:

\begin{itemize}
\item Выберите четыре стороны внутреннего квадрата.
\item Щелкните значок-переключателя-режима-строительства \icon {Sketcher_AlterConstruction}.
\end{itemize}
Теперь внутренний квадрат изменил свой цвет на синий, указывая на то, что это вспомогательные линии, которые не влияют на какие-либо элементы на основе эскиза, такие как выдавливания или вырезы.

\img{width=0.8\textwidth}{FlangeSquareConstruction}

Закройте Sketcher и щелкните значок площадки \icon {PartDesign_Pad}. Это создаст фланец:

\img{scale=0.5}{FlangeSquarePad}


\section{Дуга}
Дуга является частью окружности, поэтому дуги имеют много общего с окружностями.

\begin{tabular}{|l|l|}
\hline
Иконки: & \icon{Sketcher_CreateArc} (default)\\
       & \icon{Sketcher_Create3PointArc}\\
\hline
\dofAdded & 5\\
\hline
\end{tabular}

Дуга может быть определена положением ее центра с 2 степенями свободы, радиусом с одной степенью свободы и углом для каждой из конечных точек дуги, что в сумме составляет до 5 степеней свободы.

Как и в случае с окружностями, есть два спопсоба задания  дуг. Как только дуга создана, нет никакой разницы между двумя методами.
\begin{enumerate}
\item Метод по умолчанию начинается с центра, а затем добавляется радиус: После нажатия \icon {Sketcher_CreateArc} щелкните в 3D-виде в том месте, где вы хотите разместить центр дуги. Переместите мышь и посмотрите, как радиус меняется вслед за перемещением мыши. Щелкните для первой точки дуги. Снова переместите мышь и щелкните для второй точки дуги.
      
       Если у вас есть автоматические ограничения, вы можете выбрать существующие точки, которые создадут ограничения совпадения.
\item Чтобы выбрать альтернативный режим создания, щелкните маленький треугольник справа от значка создания дуги и выберите \icon {Sketcher_Create3PointArc}. Теперь первый и второй щелчки определяют начало и конец дуги, а третий щелчок - произвольную точку на дуге, определяющую радиус. Такой режим создания  будет по умолчанию до завершения  вашего сеанса FreeCAD, пока вы снова не поменяете его.
\end{enumerate}


\subsection*{Типовые ограничения}
\begin{description}
\item [Расположение центра,] {\bf Радиус, Равенство, Точка на объекте} ведут себя так же, как и с кругами
\item [Касание] Два режима, описанные для окружностей, существуют также и для дуг. Но есть дополнительный, наиболее важный режим для создания касания на концах, который называется \emph {гладкое соединение}.
      
       Выберите одну из конечных точек дуги и конечную точку линии или другой дуги. Если применить к ним ограничение касания, произойдут две вещи:
       \begin {itemize}
       \item элементы будут касательными
       \item точки совпадают.
      \end{itemize}
\end{description}

\vbox{
\begin{Exercise}
% comment for translators on the first mandatory space: it is inserted to
% slightly improve the clumsy linebreak at the end of the line
\ \,Создайте дугу и две горизонтальные линии. Примените ограничения касания точка-точка к верхней и нижней паре точек соответственно. На левом рисунке показан выбор непосредственно перед применением первого ограничения, на правом - результат после применения обоих.

\mbox{}\hfill\img{}{ArcTangencyPoint} \hfill \hfill \img{}{ArcTangencyPointAfter}\hfill\mbox{}
\end{Exercise}
}%

\vbox{%
\begin{Exercise}
Создайте следующий эскиз. Все дуги имеют одинаковый радиус 15\,мм. Все длинные и короткие линии равны. Все касания являются касаниями точка - точка с гладкими стыками.

\img{scale=0.95,clip,trim=0 20 0 0}{ArcExercise}
\end{Exercise}
}

\section{Полилиния}
\begin{tabular}{|l|l|}
\hline
Иконка: & \icon{Sketcher_CreatePolyline}\\
\hline
\dofAdded & в зависимости от добавленных элементов (см. ниже)\\
\hline
\end{tabular}

Полилиния - самый полезный инструмент для быстрого создания эскиза. Это гораздо больше, чем просто соединение прямых линий, есть несколько различных способов их соединения. С помощью этого инструмента могут быть созданы даже дуги.

Полилиния в ее стандартной форме добавляет последовательность линий, которые связаны ограничениями совпадения. Эти совпадения не зависят от того, включены автограничения или нет. Режим продолжения заканчивается, когда фигура закрывается, т.е.  когда вы соединяете конечную точку с  начальной точкой полилинии.

В качестве альтернативы вы можете использовать правую кнопку мыши или клавишу ESC, чтобы завершить последовательность в любое время. Как упоминалось выше, я рекомендую использовать правый щелчок на других системах, потому что вы уже держите руку на мыши, и нет опасности случайно покинуть Sketcher, нажав много раз ESC-клавишу.

Как и в случае с другими инструментами создания геометрии, вы остаетесь в режиме создания, поэтому можете сразу продолжить работу с другой полилинией.

Дальнейшее нажатие правой кнопки мыши (или нажатие клавиши ESC) полностью завершает создание полилинии.

\vbox{\begin{Exercise}
Создайте эскиз из упражнения \vref {exerciseLinesPerpendicular}, теперь используя инструмент «Полилиния».

\img{scale=0.76}{Line1}
\end{Exercise}
}


Следует отметить, что результаты будут одинаковыми независимо от того, создается ли набор линий с помощью инструмента полилинии или  отдельными линиями.

Полилиния может не только соединять линии точками совпадениями. Следующее взято из документации с добавлением информации о КСС:

Полилиния всегда начинается с отрезка прямой линии. Для ее создания щелкните мышкой - переместите - щелкните. Это добавляет --- как и любая другая линия --- к модели 4 степени свободы.

Снова переместите мышь. После размещения первого сегмента линии инструмент полилинии эскиза имеет несколько режимов, которые можно переключать с помощью клавиши M. Например, вы можете нарисовать касательные или перпендикулярные дуги, следующие за отрезком линии или дуги. Повторное нажатие клавиши M позволяет переключаться между следующими различными режимами. Числа степеней свободы даны без учета автоматических ограничений, которые могут дополнительно уменьшить КСС, например. путем применения дополнительного горизонтального ограничения.

\begin{itemize}
\label{PolylineMKey}
\item Без нажатия клавиши M добавляется линия только с ограничением совпадения. Это добавляет 2 степени свободы для новой конечной точки.
\item Нажмите клавишу M: новый сегмент - это линия, перпендикулярная предыдущему сегменту. Это добавляет 1 степень свободы.
\item Нажмите клавишу M еще раз: новый сегмент - это линия, касательная к предыдущему сегменту. Это добавляет 1 степень свободы.
\item Нажмите клавишу M еще раз: новый сегмент - это дуга, касательная к предыдущему сегменту. Это добавляет 2 степени свободы.
\item Нажмите клавишу M еще раз: новый сегмент представляет собой дугу, перпендикулярную (слева) предыдущему сегменту. Это добавляет 2 степени свободы.
\item Нажмите клавишу M еще раз: новый сегмент представляет собой дугу, перпендикулярную (вправо) предыдущему сегменту. Это добавляет 2 степени свободы.
\item Нажмите клавишу M еще раз: вы снова в том состоянии, в котором начали; линия соединяется только совпадением с предыдущим отрезком.
\item В любом из режимов дуги удерживание клавиши CTRL (MacOS: клавиша CMD) и перемещение курсора вызывает привязку дуги с шагом 45\degree{} относительно ранее созданного сегмента полилинии. В этом случае добавляется только 1 степень свободы вместо 2, потому что ограничение угла устанавливается автоматически.
\end{itemize}

\vbox{
\begin{Exercise}
Создайте следующий эскиз, используя полилинию и клавишу M. Все дуги, включая дуги под углом 45\degree{}, имеют одинаковый радиус. Длинные линии равны. Все короткие линии справа, включая те, что под углом 45\degree{} , имеют одинаковую длину.

\img{}{PolyExercise}
\end{Exercise}
}

\section{Прямоугольник}
\begin{tabular}{|l|l|}
\hline
Иконка: & \icon{Sketcher_CreateRectangle}\\
\hline
\dofAdded & 4\\
\hline
\end{tabular}

Предварительно определенные прямоугольники в Sketcher всегда имеют только горизонтальные и вертикальные линии. Такой прямоугольник может быть определен двумя его диагональными точками, каждая из которых добавляет 2 степени свободы, что в сумме дает до 4 степеней свободы.

Чтобы создать прямоугольник, щелкните мышкой первый угол, а затем диагональный противоположный угол. Результат будет такой же, как если бы прямоугольник был построен из четырех линий, соединенных точками совпадениями и ограниченных условиями вертикальности и горизонтальности.

\subsection*{Центрирование прямоугольников}
Часто прямоугольник необходимо разместить в центре системы координат. Либо в середине прямоугольника должна быть расположена другая точка (см. Упражнение \vref {ExerciseConstruction}).

Для реализации этого выберите две диагональные точки и третью точку-центр и примените ограничение симметрии \icon {Constraint_Symmetric}. Это лучше, чем применение ограничения симметрии между горизонтальной стороной и вертикальной осью, а затем другого ограничения симметрии между вертикальной стороной и горизонтальной осью. Важно выбрать центр последним, как вы увидите в разделе \vref {symmetry}.

\img{}{RectSymmetric}

\section{Многоугольник}
\label{polygon}
\begin{tabular}{|l|l|}
\hline
Иконки: & \icon{Sketcher_CreateTriangle} \\
       & \icon{Sketcher_CreateSquare} \\
       & \icon{Sketcher_CreatePentagon} \\
       & \icon{Sketcher_CreateHexagon} \\
       & \icon{Sketcher_CreateHeptagon} \\
       & \icon{Sketcher_CreateOctagon} \\
       & \icon{Sketcher_CreateRegularPolygon} \\
\hline
\dofAdded & 4 \\
\hline
\end{tabular}

Центр имеет две степени свободы, диаметр добавляет одну степень свободы, а ориентация является последней из четырех степеней свободы. Это не зависит от количества ребер многоугольника.

Когда вы создаете многоугольник, вы начинаете с середины и перемещаете мышь, чтобы определить внешний радиус и положение одного угла. Синий внешний круг является вспомогательной геометрией и поэтому не влияет на дальнейшему использованию эскиза в выдавливании или вырезах.

Наиболее часто используемый многоугольник - это, вероятно, шестигранник в сочетании с гайками и болтами:

\img {scale = 0.8} {Hexagon}

Поскольку многоугольник - это набор линий и (строительный) круг, все рекомендации, данные ранее, действуют и здесь.

Если первые ограничения, которые вы добавляете, фиксируют центр многоугольника, убедитесь, что предполагаемая цель находится близко к текущему центру, т.e. вам следует переместить многоугольник в его конечное положение. Если целевой центр находится за пределами круга, многоугольник может сжаться до чего-то непригодного для использования. Этого не произойдет, если установить размер многоугольника.

\section{Паз}
\begin{tabular}{|l|l|}
\hline
Иконка: & \icon{Sketcher_CreateSlot} \\
\hline
\dofAdded & 4 \\
\hline
\end{tabular}

Центр одного из кругов имеет 2 степени свободы. Предопределенный паз всегда создается горизонтальным или вертикальным, поэтому расстояние до другого центра добавляет 1 степень свободы, а радиус также добавляет 1 степень свободы, что в сумме составляет до 4 степеней свободы.

Создание паза начинается с щелчка в центре одного полукруга. Следующий щелчок определяет радиус и длину прорези. В зависимости от относительного положения второго щелчка слот бывает вертикальным или горизонтальным.

\vbox{
\begin{Exercise}
\label{exerciseSlot}
Создайте эскиз блока, содержащего паз для раздвижного механизма:

\img{width=0.85\textwidth}{slotExercise}
\end{Exercise}}

{\bf Примечание:} А пока разместим размеры на паз. В разделе \vref {symmetry} мы узнаем о симметрии, как центрировать паз.

\subsection*{Типичные ограничения}
Помимо ограничений, которые вы уже знаете для линий и дуг, я хочу показать, как определить паз, если известна \emph {общая длина} паза, и поэтому его следует использовать непосредственно в эскизе.

\vbox{
\begin{Exercise}
\label{exerciseSlotOuter}
Создайте такой же эскиз для раздвижного механизма, что и раньше, но теперь установите общую длины:

\img{width=0.85\textwidth}{slotExerciseOuter}
\end{Exercise}
Этот эскиз еще не полностью ограничен, в нем отсутствуют координаты по x и y.
}

Для создания эскиза:
\begin{itemize}
\item Создайте прямоугольник и прорезь, как раньше.
\item Создайте точку и разместите на ее одной из дуг с ограничением точки на объекте. Лучше всего разместить ее рядом с конечным положением. Если у вас включены автоблокировки, вы можете сделать это за один шаг.

\img{}{slotPointOnArc}
\item Проделайте то же самое с другой дугой.
\item Выберите новую точку и центр дуги и примените ограничение по горизонтали. На изображении показана ситуация после применения ограничения. Я выбрал задействованные элементы, они показаны зеленым.

\img{}{slotPointOnArcAfter}
\item Проделайте то же самое с другой дугой.
\item Примените ограничение горизонтального расстояния к внешним точкам.
\item Примените другие ограничения, как и раньше.
\end{itemize}

\subsection*{Наклонные пазы}
Предустановленные пазов могут быть горизонтальными или вертикальными. Это разумно, потому что большинство пазов ориентировано именно так, и их можно создать всего за два щелчка мышки. Однако, если вам нужен наклонный паз, этого можно добиться, просто удалив горизонтальное / вертикальное ограничение. Это добавит еще одну степень свободы. На изображении я уже добавил угловое ограничение:

\label{SlotTilted}
\img{}{SlotTilted}


\section{B-сплайны}
\begin{tabular}{|l|l|}
\hline
Icons: & \icon{Sketcher_CreateBSpline} open B-spline\\
       & \icon{Sketcher_Create_Periodic_BSpline} closed B-spline\\
\hline
\dofAdded & 3 for each control point \\
\hline
\end{tabular}

Каждая контрольная точка обозначена кружком с 3 степенями свободы.

B-сплайны - это кривые, которые используются для гладких поверхностей. Они определяются набором контрольных точек, которые сами - за исключением начала и конца - не должны лежать на B-сплайне. Каждая контрольная точка имеет вес, который определяет, насколько контрольная точка "притягивает" кривую. B-сплайны часто возникают, когда вы импортируете файлы масштабируемой векторной графики (SVG) и применяете Draft-to-Sketch.

Есть 2 варианта B-слайнов: 
\begin{description}
\item [Открытый B-сплайн] \icon {Sketcher_CreateBSpline} имеет начало, которое является первой контрольной точкой, и конец, который является последней контрольной точкой.
\item [Замкнутый B-сплайн] \icon {Sketcher_Create_Periodic_BSpline} создается таким же образом, но при создании  конец B-сплайна плавно соединяется с началом.
\end{description}

\vbox{\begin{Exercise}
Создайте B-сплайн со следующими контрольными точками. В данный момент абсолютные расстояния между точками  значения не имеют.

\img{}{BSplineCreate}
\end{Exercise}}

Начните слева, добавьте верхнюю контрольную точку и, наконец, правую. Завершите создание B-сплайна щелчком правой кнопки мыши или используйте клавишу ESC. B-сплайн создается с одинаковым размером для всех окружностей вокруг контрольных точек. Обратите внимание, что B-сплайн не отображается, пока создание не будет завершено.

У вас есть две возможности повлиять на форму B-сплайна с помощью верхней контрольной точки (конечно, те же возможности существуют и для других точек).

\begin{itemize}
\item Положение контрольной точки определяет направление и степень отклонения B-сплайна:
%You can move the control point around.

{\newcommand{\scale}{0.54}
\hspace*{-0.8\leftmargini}\img{scale=\scale}{BSplineMoveUp}%
\hfill%
\img{scale=\scale}{BSplineMoveLeft}%
\hfill%
\img{scale=\scale}{BSplineMoveRight}}

Вы видите, как кривая притягивается контрольной точкой. Соотношение между контрольной точкой, кривой и другими точками остается примерно постоянным.

\item Размер кружков вокруг контрольных точек определяет степень притяжения кривой. Чем больше круг, тем больше притягивается B-сплайн. Бесконечный круг притянет его к самой контрольной точке.
      
      Перед изменением размера отдельной контрольной точки необходимо удалить ограничение равенства.

\img{}{BSplineBigCircle}
\end{itemize}

\subsection*{Типичные ограничения}

B-сплайны поддерживают все ограничения, которые мы видели на контрольных кругах.

Невозможно (пока) использовать ограничения, такие как касание или точка на объекте, на кривой B-сплайна, а только на его конечных точках; однако ниже вы найдете некоторые методы, как это имитировать.

\begin{description}
\item [Ограничение блока.]
Хотя очень разумно использовать для конечных точек ограничения, отличные от ограничений блока, это может загромождать эскиз размерами, если вы хотите ограничить все контрольные точки между ними.

Здесь имеет смысл использовать блочное ограничение на B-сплайне. Убедитесь, что вы применили все другие ограничения раньше, потому что после применения ограничения блока ничего нельзя изменить в любой точке B-сплайна. \footnote {Начиная с v. \currentVersion {}, Sketcher не сообщает о таких сверхограничениях. }

\newlength{\listWidth}
\setlength{\listWidth}{\textwidth}
\addtolength{\listWidth}{-\leftmargini}
\begin{minipage}{\listWidth}
\begin{Exercise}
\label{BSplineBlock}
Создайте B-сплайн, как показано на следующем рисунке. Ограничение блока выровнено довольно далеко слева, но оно принадлежит кривой B-сплайна.
\img{}{BSplineBlock}
\end{Exercise}
\end{minipage}

Перед применением ограничения блока укажите общую длину (55 мм) и подберите размер большего круга (не устанавливая его как ограничение).

\item [Касательные и перпендикулярные ограничения на конечных точках.] Дуги и линии --- а с помощью вспомогательной линии даже B-сплайны --- могут быть соединены в их конечных точках с использованием касательных или перпендикулярных ограничений.

\begin{Exercise}
Удалите ограничение блока из упражнения \vref {BSplineBlock}. Проведите горизонтальные линии, касательные слева, перпендикулярные справа.
\end{Exercise}

\hspace*{-\leftmargini}\img{scale=1}{BSplineTangent}%
\hfill%
\raisebox{1cm}{$\stackrel{\iconSmall{Constraint_Tangent}}{\longrightarrow}$}%
\hfill%
\img{scale=1}{BSplinePerpendicular}%
\hfill%
\raisebox{1cm}{$\stackrel{\iconSmall{Constraint_Perpendicular}}{\longrightarrow}$}
\hfill%
\img{scale=1}{BSplineTangentPerpendicular}%

Последним действием снова добавьте ограничение блока.


\item [Ограничение касательной на кривой.] В настоящее время невозможно создать касательную на внутренней части B-сплайна. То же верно и для точек, лежащих на кривой.
      
       В качестве обходного пути вы должны создать два B-сплайна и соединить их по касательной. Это тоже не работает напрямую, поэтому вам нужно добавить вспомогательную линию.
      
       \paragraph {Предупреждение:} Вы не получите автоматически точно такую же кривую, как с одним B-сплайном, но вы можете подойти очень близко.

\begin{Exercise}
На основе упражнения \vref {BSplineBlock} добавьте касательную к вершине B-сплайна.

\img{}{BSplineInnerTangentAll}
\end{Exercise}

Здесь задействованы два B-сплайна:

\img{width=0.43\textwidth}{BSplineInnerTangentLeft}\hfill\raisebox{15ex}{and}\hfill\img{width=0.43\textwidth}{BSplineInnerTangentRight}

Есть разные возможности добавить касательную:
\begin{itemize}
\item Вы можете разместить конечную точку и контрольную точку рядом с ней на касательной. Это то, что я сделал в примере.
\item Вы можете использовать ограничения касательной точка-точка для конечных точек.
\end{itemize}

\item [Точка на объекте на кривой.] Создайте его аналогично касательной.
\item [Перпендикуляр на кривой.] Создайте его аналогично касательной.
\end{description}

\pagebreak[3]
\section{Сечение конуса}
Вы найдете сечения конуса в раскрывающемся меню иконки \icon {Sketcher_Conics}. После того, как вы выбрали пункт меню, эта иконка заменяется последним выбранным пунктом.

\begin{tabular}{|l|l|}
\hline
Иконки: & \icon{Sketcher_CreateEllipse} Эллипс по центру, малому и большому радиусу, 5 степеней свободы\\
       & \icon{Sketcher_CreateEllipse_3points} Эллипс по большой и малой оси, 5 степеней свободы\\
       & \icon{Sketcher_Elliptical_Arc} Дуга эллипса, 7 степеней свободы\\
       & \icon{Sketcher_Hyperbolic_Arc} Дуга гиперболы, 7 степеней свободы\\
       & \icon{Sketcher_Parabolic_Arc} Дуга параболы, 6 степеней свободы\\
\hline
\end{tabular}

КСС эллипса задается двумя определяющими линиями, которые составляют до 8 степеней свободы. Они уменьшаются за счет линий, имеющих общий центр (минус 2 степени свободы) и перпендикулярных (минус 1 степень свободы). Это составляет до 5 степеней свободы.

У дуги эллипса есть 2 дополнительных степени свободы: каждая из начальных и конечных точек может быть определена углом, добавляющим по одной степени свободы каждая. В сумме это до 7 степеней свободы.

Гипербола также определяется двумя перпендикулярными линиями - на этот раз соединенными как Т - и двумя углами, что в сумме составляет до 7 степеней свободы.

Парабола определяется линией между фокусом и вершиной с 4 степенями свободы и двумя углами для конечных точек. Это составляет до 6 степеней свободы.

\subsection{Создание и использование конических сечений}
Использование конических сечений очень просто. Есть одно исключение из особого поведения при использовании касательных, которое будет описано ниже (см. Раздел \vref {ConicalTangent}).
\begin {itemize}
\item Вы можете использовать вспомогательные линии (см. раздел \vref {ConstructionGeometry}) для дальнейшего ограничения вашей модели.
\item Вы можете использовать кривую так же, как это было описано для окружностей и дуг:
       \begin {itemize}
       \item добавить ограничения касательности между кривой и линиями
       \item добавить касание точка-точка между концами конических дуг и другими геометрическими элементами
       \item добавить перпендикулярные ограничения между конечными точками конических дуг и другими геометрическими элементами
       \end {itemize}
\end {itemize}

\subsection {Касание и перпендикуляр на конических сечениях}
\label {ConicalTangent}
Если вы хотите создать ограничение касания между коническим сечением и другой кривой типа коническое сечение, окружность или дуга, вы должны поступить как обычно: выберите обе кривые и примените ограничение. Однако эффект немного другой:

\begin{itemize}
\item Создается дополнительная точка;
\item Эта точка размещается на обеих кривых с двумя ограничениями точки на объекте;
\item Создано ограничение касания.
\end{itemize}

\img{scale=1}{ConicalTangent}

Такой же метод используется для создания ограничения перпендикулярности между коническим сечением и линией:

\img{scale=1}{ConicalPerpendicular}

\section{Вспомогательная Геометрия}
\label{ConstructionGeometry}
\vbox{
Вспомогательная геометрия может использоваться, когда геометрия не будет использоваться для создания дополнительных элементов, а только для построения самого эскиза. Мы  уже использовали ее в упражнении \vref {ExerciseConstruction}, также она генерируется автоматически, например при создании многоугольника см. раздел \vref {polygon}.
}

Вспомогательная геометрия имеет синий цвет, чтобы отличить ее от того, что я назову здесь «реальной» или «нормальной» геометрией, которая имеет белый цвет. У вас есть две возможности для создания вспомогательной геометрии:
\begin {itemize}
\item Выбрав геометрический элемент и щелкнув значок переключения режима построения \icon {Sketcher_AlterConstruction}, вы можете переключаться между вспомогательной и реальной геометрией. Это означает, что вы также можете пойти другим путем и превратить вспомогательную геометрию в реальную.
\item Если ничего не выбрано и вы щелкнете значок-переключателя-режима-строительства \icon {Sketcher_AlterConstruction}, все значки для создания геометрии станут синими, и вы войдете в режим строительства. В этом режиме все геометрические элементы являются вспомогательными.

       Чтобы выйти из этого режима, снова нажмите значок переключения-режима-строительства.
\end{itemize}


Я часто использую вспомогательную геометрию, когда хочу иметь равные расстояния до некоторой внешней границы эскиза.

\begin{Exercise}
Создайте нетривиальный эскиз с внутренней и внешней границами на одинаковом расстоянии между ними.
\end{Exercise}
\hspace{\leftmargin}\img{width=0.78\textwidth}{ConstructionReady}

Для этого:
\begin{itemize}
\item Начните с полностью ограниченного эскиза внешней границы
\item Добавьте внутреннюю границу с такой же структурой. Ваш набросок будет выглядеть примерно так: 

       \img{width=0.75\textwidth}{ConstructionPrep}
\item Перейти в режим строительства
\item Добавьте вспомогательные линии. Включив автоматические ограничения, вы можете добавлять ограничения по горизонтали, вертикали и точке на объекте во время строительства. Если некоторые из них отсутствуют, примените их после создания.
\item Примените ограничение равенства между всеми линиями построения.
\item Добавьте ограничение расстояния по горизонтали или вертикали к одной из вспомогательных линий.
\end{itemize}

Вспомогательная геометрия добавляется в список элементов, как и вся остальная геометрия. Соответствующие значки имеют на концах синие точки вместо красных.

\img {scale = 1} {ConstructionListOfElements}

\section {Точка}
\label {Point}
Дело в геометрическом элементе, о котором мы еще не говорили. Невозможно переключаться между реальной и вспомогательной геометрией, это всегда строительная геометрия.

\begin {tabular} {| l | l |}
\hline
Значок: & \icon {Sketcher_CreatePoint} \\
\hline
\dofAdded & 2 \\
\hline
\end {tabular}

Точка может быть ограничена фиксацией координат x и y, таким образом имея 2 степени свободы.

Точка служит только строительной геометрией. Невозможно построить эскиз, содержащий только точку, как реальную геометрию. (Это было бы желательно для чердаков, которые заканчиваются одной точкой.) Это справедливо для текущей версии 0.19, это может измениться в будущем. Если вам нужна такая точка, как реальная геометрия, вы должны использовать верстак Draft или Part.

Используйте точку для определения остальной части эскиза, если точка необходима, но не задана непосредственно геометрией. Это может быть, например, центр двух прямоугольников, определенная точка на окружности и т. д. Для примера см. слот упражнение \vref {exerciseSlotOuter}.

\newpage

\part{Constraints}
\label{Constraints}
The constraints make the Sketcher unique among the workbenches and
distinguish it from most other 2D drawing programs as well. Especially the geometric
constraints like coincidence, equality, point-on-object, tangency, etc. make a model
independent of too many dimensions thus improving readability and parametricity.
Imagine a sketch with a single slot and you had every single point constrained with
x- and y-measure. That would sum up to 18 measures. And now imagine you had two or
three of those slots and you had to move this sketch a certain amount up and to the
right. You would have to change and to calculate every single of these measures---what a pain.

In this section I want to discuss the different constraints and how they are handled.

While geometric elements add DOF to a model, constraints are doing the opposite: they
reduce the number of DOF. Below I will say a constraint \emph{consumes} a
certain number of DOF. This is something you should always have in mind. I am
always watching the solver messages and how they change on application of a new
constraint. This gives me some satisfaction seeing the approach towards zero, but
it is of course more important, that I can intervene immediately if something goes wrong.

\section{Selecting Constraints}
This seems to be a simple task, but there are more possibilities beyond the obvious
way. Whenever you select a constraint by any of the means below, the constraint will
be selected in 3D view as well as in the list of constraints in the panel to the
left.
\begin{description}
\item [Click on the constraint in 3D view] This is probably the most frequently used
      possibility.
\item [Double click on a numerical value in 3D view] such as distance or radius. If you
      want to change the value of a measure, double click on the constraint
      and enter the new value.
\item [List selection] Sometimes it is difficult to select an existing
      constraint in the 3D view. In the current 0.19 version it
      seems to be impossible to select one of multiple constraints if more
      than one is attached to a geometric element (on the Mac this seems to be
      slightly worse than on Ubuntu).\\
      In that case you can select it from the list of constraints in the panel at the
      left side. This is the safest way to determine the last constraint added, as it
      is the last in the list.
\item [Select constraints associated with a geometric element] If you have selected a
      geometric element, you can use the icon \icon{Sketcher_SelectConstraints} to
      select all the associated constraints including coincidences at the endpoints.
      At the same time the selection of the geometric element is discarded.
\item [Select geometric elements associated with a constraint] If you have selected a
      constraint, you can use the icon
      \icon{Sketcher_SelectElementsAssociatedWithConstraints} to select all the
      associated geometric elements. At the same time the selection of the
      Constraint is discarded.
\item [Box selection] This selection type is---as far as constraints are
      concerned---useful for selecting coincidence constraints. On the other hand it
      can be used to select endpoints of geometric elements which lie on top of each
      other, e.\,g. in order to apply a tangency or perpendicular constraint:\\
      You can draw a rectangle while holding left mouse button down.
      Depending of the direction of the selection different things happen:
      \begin{itemize}
      \item From left to right all Elements, that are \emph{completely inside} of the
            selection rectangle, are selected.
      \item From right to left all Elements, that are at least partially inside of
            the rectangle are selected.
      \end{itemize}
    
      See exercise \vref{ExampleBoxSelection} for a box selection example.
\end{description}

\section{Applying constraints}
\label{ApplyingConstraints}
There are two different modes for applying constraints to geometric elements. The
behaviour can be configured in

Preferences\menu Sketcher\menu General\menu Constraint Creation "Continue
Mode".\label{continueConstraints}


\begin{itemize}
\item You can apply a constraint as before in this lecture: Select one or---depending
      on the type of constraint---more geometric elements and then click the icon for
      the constraint.
\item The other mode is similar to continuous creation mode of geometry: Without
      having selected any geometric element in the sketch click a constraint icon. As
      an example let's say you clicked the vertical constraint icon. You can now
      select subsequently all the lines which are supposed to have a vertical
      constraint.
      
      For constraints that require selection of more than one geometric element like
      point-on-object the constraint is applied as soon as you have selected enough
      elements. With some constraints like symmetry the sequence of the selection is
      meaningful.
      
      To end continuous constraint mode click the right mouse button or hit the
      escape key or select something else from the geometric elements list.
\end{itemize}

\section{The Solver}
\subsection{Solving a Sketch}
For the solver a sketch is a---possibly huge---system of equations. The solver tries to
find a solution which in the best case is unique.

A sketch is said to be solved, if all constraints are fulfilled and there is no other
"near-by-solution", i.e. you cannot move some part of the sketch continuously while
the solution is still valid. This condition is a bit complicated, because a sketch
can well be marked as solved although the solution is not unique. The following
exercise shows two sketches which are both fully constrained and have both the same set
of constraints. Yet they are different!

\vbox{
\begin{Exercise}
\label{nonUnique}
Create a sketch according to the following image

\img{}{unique1}
\end{Exercise}
}

Left and upper side are equal. The three short lines are equal.


Now we will create a different solution based on the same set of constraints:
\begin{itemize}
\item Remove the equality constraint from the short horizontal line. In the image it
      is constraint number 17.
\item Move the right end of the sketch to the left. Move it until the lower short
      vertical line is left of the upper short vertical line.
\item Apply the equality constraint again, and you have the same set of constraints
      as before.
\end{itemize}

\img{}{unique2}

\subsection{Flipping Sketch}
\label{Flip}
The behaviour sometimes leads to unexpected results, because multiple small changes
lead to different results than one big change.

\begin{Exercise}
Create a sketch according to the following image

 \img{}{Jump1}
\end{Exercise}
Now increase the length of the upper line in two steps to 60\,mm

{\newcommand{\scale}{0.8}
\vbox{\img{scale=\scale}{Jump2}

\begin{picture}(50,10)
\put(40,10){\vector(0,-1){10}}
\end{picture}
\\[1ex]
\img{scale=\scale}{Jump3}}

The sketch behaves like expected.

Now go back to the 10\,mm version and change it in one step to the final 60\,mm:

\img{scale=\scale}{Jump4}
}

The left horizontal line has flipped its direction. If this happens to a
sketch I usually undo the last action and move the {\em elements manually as close as
possible to their final destination}.\footnote{In Preferences\menu
Sketcher\menu General you can select the option "Show Advanced Solver
Control". After reopening Sketcher you have an additional subsection
\emph{Advanced solver control} in the panel. If you select Levenberg-Marquardt
as default you often can avoid jumping sketches.}

\paragraph{Increase robustness} You can improve robustness if you use angle
constraints of 90\degree{} instead of horizontal or vertical constraints 
(see section \vref{Angle}). However, it is not advised to do this always,
because it puts more stress on the solver and spoils the sketch.

\subsection{Solver Messages}
Whenever you do something that changes the DOF, like adding or removing a geometric
element or adding or removing a constraint, the solver recalculates the whole Sketch
to determine a solution and responds with a certain message. Some of them are desired
in the process of developing a sketch and some show error states.

\subsubsection{Messages you want to see}
\begin{description}
\item [Under-constrained sketch] Let's recall the two lines example about
      autoconstraints from section \vref{auto3}:

\img{}{ConstraintsSolverUnder}

You can click on the blue part in the solver message, here it says \textcolor{blue}{1
degree}. This will select elements in the sketch where additional constraints should be
applied for further constraining. In this example the upper horizontal
line will be selected.

There cannot be any further recommendation about how to constrain the sketch, because
it is up to you. Think about it and apply the appropriate constraint. In this case it
could be a horizontal length or an equality constraint. Even a point-on-object
constraint would be possible between the endpoint and the Y-axis, thus flipping the
line by 180\degree.
\item [\textcolor{darkGreen}{Fully constrained sketch}] in friendly green color. This is
      what you should always try to achieve!

\img{}{ConstraintsSolverFull}
      
      Sketches can be used for pads and pockets without being fully constrained, but
      experience has shown that in some rare cases there were issues with
      using sketches that were not fully constrained.
\end{description}

\subsubsection{Unwanted Messages}
There are different issues of different severeness, most of them detected and
reported by the solver.

Please note: {\bf\em When the sketch is in such an error state it is no longer updated
in 3D view. You cannot move the sketch or parts of it, further constraints which
might well be correct don't show any consequences in the view until you have
corrected the error.}

The following is ordered by severeness, worst coming first:
\begin{description}
\item [Sketch unsolved] In the sketch below I had applied a symmetry constraint on
      the endpoints of the line and the Y-axis. This made the line horizontal and had left 2 DOF. Then I have added
      a (contradicting) vertical constraint on the line. This left the message as
      before, but added "Unsolved" in red. You should handle it by deleting the
      constraint added last, because the solver cannot give you any hints on the
      constraints involved.

      This shows once again the importance of always watching the solver messages.      

 \img{}{ConstraintsSolverUnsolved}

      This situation comes in different flavors, depending on the solver message you
      had before you added the conflicting constraint. If you close and reopen the
      sketch you get the message "Undefined degrees of freedom".

\img{}{ConstraintsSolverUndefined}

\item [Sketch contains conflicting constraints] In this example

      \img{}{ConstraintsSolverConflicting}

      I have applied a coincidence constraint on the two selected points. Of course
      this is not possible because they cannot be 10\,mm apart and coincident at the
      same time. The solver detects and reports this.

      The solver lists all candidates of constraints of which you should delete at
      least one. You can click on the blue part in the solver message, which will
      select \emph{all} of these candidates. If you delete them you will have deleted
      far too much.

      If you always watch the solver messages you will realize immediately that
      something is wrong. So you should analyze why the last constraint leads to this
      error message. Most often you will remove the last constraint and replace it
      with the right one. In the example given here a horizontal constraint
      \icon{Constraint_Horizontal} or a vertical distance
      \icon{Constraint_VerticalDistance} could be appropriate.

      In some cases it can be sensible to remove or replace some other constraint
      than the last one. In the example the 30\,mm constraint could be
      removed, after which the coincidence could be applied without errors.

\item [Over-constrained sketch] This is a special form of the previous one,
      with the additional condition that there are more degrees of freedom
      consumed by the constraints than are added by the geometric elements.
      In the following example I have a fully and well constrained Sketch with
      one horizontal line. It's length is defined and it is symmetric to the
      origin.

\img{}{ConstraintsSolverOver1}

      If now an additional coincidence constraint is applied to the right end
      of the line and the origin, then there are too many constraints and they
      are conflicting.

\img{}{ConstraintsSolverOver2}


\item [Sketch contains redundant constraints]You get this message when a
      constraint is implied by one or more of the other constraints. In the
      following example I had the line with a horizontal constraint. Then I selected
      both endpoints and the Y-axis and added a symmetry constraint. The symmetry
      implies the horizontal constraint. The solver detects this, and makes in this
      case a perfect proposal which I can follow by clicking on the blue "click to
      select" and delete it.
      
      Please note that in this case it is not sensible to remove the last constraint
      added.

\img{}{ConstraintsSolverRedundant}

\item [(normal display)] showing DOF or even the "fully constrained" message. But yet
      it is over\-con\-strained. This is not too serious, and everything works
      as expected, but I recommend to avoid it nevertheless, because you
      usually could simplify the set of constraints, and simpler is always
      better, if the result is the same.

      These overconstraints occur when a constraint is added which consumes
      more than one DOF, and there is no other constraint which can be removed
      completely. The solver silently drops the redundant part of a constraint.

      As an example create a sketch in the way described below:

%\img{}{ConstraintsSolverOverNoMessage}
      \begin{itemize}
      \item Create an equilateral triangle and fix the length of a side. You
            have 3 DOF.

\newcommand{\scale}{0.66}%valid inside itemize
\img{scale=\scale}{equiTriangle1}

  \item Add a symmetry constraint making two points symmetric to the x-axis.
        This consumes 2 DOF leaving 1 DOF.

\img{scale=\scale}{equiTriangle2}

      \item Create a coincidence constraint between the point positioned on
            the x-axis and the origin. 

\img{scale=\scale}{equiTriangle3}

      Coincidence consumes 2 DOF, so a redundancy could be expected; however,
      the solver detects this as correctly fully constrained.
      \end{itemize}

      As said before, you should always watch the solver messages in order to
      detect these issues.
      It should be noted that in these cases a different sequence of applying
      the constraints can lead to different results. If you create in the
      example above the coincidence first and then the symmetry you get an
      "unsolved" sketch.

      A proper way to constrain this would be to replace one of the
      constraints consuming two DOF by a constraint consuming only one.
      You could e.g. replace the symmetry by a vertical constraint or the
      coincidence in the center by a point-on-object on the y-axis.
\end{description}


\section{Coincidence}
\begin{tabular}{|l|l|}
\hline
Icon: & \icon{Constraint_PointOnPoint}\\
\hline
\dofConsumed & 2 \\
\hline
\end{tabular}

The coincidence stops a point from moving in two directions, thus consuming 2 DOF.

There is an important difference between two points having the same
coordinates and being coincident. Especially when you have grid snapping
enabled this can lead to confusion. The following exercise will show the difference
and shows the technique of Box Selection, which comes handy when dealing with
coincidences.

\begin{Exercise}
\label{ExampleBoxSelection}
Create a fully constrained rectangle, which means you have 0 DOF.

\img{}{Coincidence1}
\end{Exercise}
Now select one by one the upper corners with box selection from left to right and
remove what's in the box.

\img{scale=0.9}{Coincidence2}\hspace{2em}\img{scale=0.9}{Coincidence3}

This will leave the sketch with 4 DOF, although the position of all geometric
elements is exactly the same as before. If you want, you can now move the upper line,
which wasn't possible before.

\img{scale=0.7}{Coincidence4}

With some experience---as soon as you are sure whether two points \emph{are} coincident
or \emph{only look like}--- you will probably use box selection the other way
round: Select the endpoints with box selection and apply the coincidence.

For beginners I like to recommend something else: Move one of the points you want to
have coincident, being fully aware that it is off its final destination. When you
apply the constraint you can see it snap into position.

See section \vref{ValidateSketch} for an additional tool to check if you have missed any
coincidences.


\section{Point on Object}
\label{PointOnObject}
\begin{tabular}{|l|l|}
\hline
Icon: & \icon{Constraint_PointOnObject}\\
\hline
\dofConsumed & 1 \\
\hline
\end{tabular}

A point-on-object constraint fixes a point e.g. on a horizontal line in vertical direction, while it still
can move on the line. This consumes 1 DOF.


\typeout{ask "curve or arc" for following paragraph}
Very often point-on-object is used to fix a point on X or Y axis. But it can be used
to fix a point on a line as well as on a curve. This constraint cannot yet be applied
on B-splines. If nothing else is fixed the point can move on the line or on the arc
respectively.
In exercise \vref{exerciseLinesPerpendicular} we have already seen, that it is not
necessary that the point lies on the line segment forming the geometry. The same
holds for arcs or other curves.

\begin{Exercise}
Create a sketch according to the following image using point-on-object constraints on
X-axis (twice) and Y-axis.

\img{}{PointOnLine1}
\end{Exercise}

The center of the circle is coincident with the origin. There is one DOF left,
because the lower point can move freely up and down the Y-axis.

We fix the last DOF with another point-on-object constraint. Select the lower point
and the arc and apply point-on-object:

\img{height=5cm}{PointOnLine2}
\hspace{1cm}
\raisebox{2cm}{$\stackrel{\icon{Constraint_PointOnObject}}{\longrightarrow}$}
\hspace{1cm}
\img{height=5cm}{PointOnLine3}

The lower point lies now on the virtual extension of the arc.


\section{Vertical}
\label{Vertical}
\begin{tabular}{|l|l|}
\hline
Icon: & \icon{Constraint_Vertical}\\
\hline
\dofConsumed & 1 \\
\hline
\end{tabular}

The vertical constraint is usually applied to lines, and---as name and icon
suggest---defines the orientation of the line being vertical.

Here are some remarks concerning the application of vertical constraints:

\begin{itemize}
\item After having created a rough outline of a sketch it can be sensible to enter
      continuous mode for applying vertical constraints. See section
      \vref{ApplyingConstraints} for details.
\item You can select more than one line and apply vertical to all of them at once.
      Although this seems to require the same effort as the continuous mode there is
      an important difference: If you miss a line and click in the free area all
      previously selected lines are deselected. So be careful if you have lots of
      verticals or apply the constraint after selecting only some of the lines.
\item Vertical constraint can be applied to points instead of lines. Select two or
      more points and apply the vertical constraint. This aligns the points
      vertically stacked, without needing any further construction elements.\\      
      This is frequently used if you want to access the topmost or bottommost point
      of an arc or circle.
      
      A horizontal distance measure of 0\,mm which has the same effect should be avoided.
\end{itemize}

\begin{Exercise}
Create a slot according to the following image:

\img{scale=0.7}{VerticalPoints}
\end{Exercise}
The top and bottom point in the slot are additional Points, see section \vref{Point}
for details. They have a vertical constraint with the center of the lower arc.


\section{Horizontal}
\label{Horizontal}
\begin{tabular}{|l|l|}
\hline
Icon: & \icon{Constraint_Horizontal}\\
\hline
\dofConsumed & 1 \\
\hline
\end{tabular}

Everything which has been said about the vertical constraint applies for the
horizontal constraint as well, with the only difference, of course, that instead of
vertical, lines and points are aligned horizontally.

\section{Parallel}
\begin{tabular}{|l|l|}
\hline
Icon: & \icon{Constraint_Parallel}\\
\hline
\dofConsumed & 1 \\
\hline
\end{tabular}

This constraint limits the orientation of a line -- like a vertical or horizontal constraint -- to
a certain direction and consumes 1 DOF.

Select two or more lines and click the icon \icon{Constraint_Parallel}. This makes
all selected lines parallel. In continuous mode you can select subsequent pairs of
lines which are then made parallel.

\begin{Exercise}
Create a sketch according to the following image. Use continuous mode.

\img{width=0.6\textwidth}{Parallelogramm}
\end{Exercise}

There are two cases where you cannot or should not use parallel constraints.
\begin{itemize}
\item You should not use parallel on vertical or horizontal lines. Use the dedicated
      vertical and horizontal constraints instead
\item You cannot use a parallel constraint on arcs or circles. If you want to have
      concentric circles you should make their centers coincident.
\end{itemize}

\section{Perpendicular}
\begin{tabular}{|l|l|}
\hline
Icon: & \icon{Constraint_Perpendicular}\\
\hline
\dofConsumed & 1 for line/line;
                            see paragraph (\ref{PerpendicularLineLine}) below \\
                        & 2 for point/line;
                            see paragraph (\ref{PerpendicularPointLine}) below \\
                        & 3 for point/point;
                            see paragraph (\ref{PerpendicularPointPoint}) below \\
\hline
\end{tabular}

The perpendicular constraint comes---similar to the tangency in section
\vref{Tangency}---in three different flavors, controlling different behaviour on the
endpoints.

\begin{enumerate}[(a)]
\item \label{PerpendicularLineLine} For the basic variant select two lines and apply
      the perpendicular constraint. The following example shows, that the lines don't
      have to cross to be perpendicular:

\begin{Exercise}
Create two lines with considerable distance between them and apply the perpendicular
constraint:

\img{width=0.4\textwidth}{Perpendicular1}
\hfill
\raisebox{1cm}{$\stackrel{\icon{Constraint_Perpendicular}}{\longrightarrow}$}
\hfill
\img{width=0.4\textwidth}{Perpendicular2}

\end{Exercise}

The perpendicular constraint can be applied between a line and a circle or an arc as well:

\img{width=0.4\textwidth}{PerpendicularLineCurve1}
\hfill
\raisebox{1cm}{$\stackrel{\icon{Constraint_Perpendicular}}{\longrightarrow}$}
\hfill
\img{width=0.4\textwidth}{PerpendicularLineCurve2}

Remark: A point-on-object constraint between the center of the arc and the line would have
the same effect.

\item \label{PerpendicularPointLine} If we select a line and an endpoint of another
      line before applying the perpendicular constraint we get the same perpendicular
      arrangement as before, but now the endpoint is also constrained on the line:

\img{width=0.4\textwidth}{PerpendicularLinePoint3}
\hfill
\raisebox{1cm}{$\stackrel{\icon{Constraint_Perpendicular}}{\longrightarrow}$}
\hfill
\img{width=0.4\textwidth}{PerpendicularLinePoint4}

      
      To be precise: the point does not lie on the real line segment, but on the
      infinite line:
      
\img{width=0.4\textwidth}{PerpendicularLinePoint1}
\hfill
\raisebox{1cm}{$\stackrel{\icon{Constraint_Perpendicular}}{\longrightarrow}$}
\hfill
\img{width=0.4\textwidth}{PerpendicularLinePoint2}

Again we can apply this constraint on a line and an arc:

\img{}{PerpendicularCurvePoint}

\item \label{PerpendicularPointPoint} If you select the endpoints of two lines or of
      an arc and a line or of two arcs and apply the perpendicular constraint
      the two lines\,/\,arcs are made perpendicular \emph{and} the selected
      points are made coincident. This is the type of perpendicular constraint
      that is created automatically with the polyline using the M-key, see
      section \vref{PolylineMKey}.

\img{}{PerpendicularPointPoint1}
\hfill
\raisebox{1cm}{$\stackrel{\icon{Constraint_Perpendicular}}{\longrightarrow}$}
\hfill
\img{}{PerpendicularPointPoint2}

\img{height=3.8cm}{PerpendicularPointArc1}
\hfill
\raisebox{1cm}{$\stackrel{\icon{Constraint_Perpendicular}}{\longrightarrow}$}
\hfill
\img{height=3.8cm}{PerpendicularPointArc2}

\img{height=3.8cm}{PerpendicularArcArc1}
\hfill
\raisebox{1cm}{$\stackrel{\icon{Constraint_Perpendicular}}{\longrightarrow}$}
\hfill
\img{height=3.8cm}{PerpendicularArcArc2}
\end{enumerate}



\subsubsection*{Things you should not or cannot do}
\begin{itemize}
\item You should \emph{not} use the perpendicular constraint to create
      vertical or horizontal constraints. Use always the simplest constraint
      possible, which is in case of horizontal lines the horizontal constraint
      (see section \vref{Horizontal}) and for vertical lines the vertical constraint
      (see section \vref{Vertical}).
\item You cannot use a line-to-line perpendicular constraint on two circles
      or arcs. However, using a construction line and tangency you can well achieve this
      target. We will come back to this at the end of the section about
      tangency (see section \vref{ExercisePerpendicularArcs}).
\end{itemize}

\section{Tangency}
\label{Tangency}
Tangency comes in different flavors controlling different behaviour on the endpoints.

\begin{tabular}{|l|l|}
\hline
Icon: & \icon{Constraint_Tangent}\\
\hline
\dofConsumed & 1 (curve/curve) \\
             & 2 (point/curve) \\
             & 3 (point/point) \\
             & 2 (line/line) \\
\hline
\end{tabular}

\begin{description}
\newcommand{\height}{6.2cm}
\item [Curve to curve, including line to curve] Take a line where one endpoint is fixed. There are 2 DOF left for the other
      endpoint. If the line touches a given circle, there is only 1 DOF
      left, because the point can be moved only in the fixed direction of the line.
      This results in 1 DOF for this curve/curve type of tangency.
      
      Please note that the green color in the left image is \emph{not} signaling that
      it is fully constrained, it is the selection before applying the tangency
      constraint.

\img{height=\height}{TangentCurveCurve1} 
\hfill
\raisebox{2cm}{$\stackrel{\icon{Constraint_Tangent}}{\longrightarrow}$}
\hfill
\img{height=\height}{TangentCurveCurve2}


Similar to point-on-object constraint when applying a curve/curve tangency constraint,
the tangent elements don't have to touch:

\img{height=5cm}{TangentNoTouch}

\item [Point to curve.] If in the same situation the endpoint of the line should touch the
      circle, then nothing can be moved at all. This means that point/curve consumes 2 DOF.

\img{height=\height}{TangentPointCurve1} 
\hfill
\raisebox{2cm}{$\stackrel{\icon{Constraint_Tangent}}{\longrightarrow}$}
\hfill
\img{height=\height}{TangentPointCurve2}

\pagebreak[4]
\item [Point to point.] If you have a fixed arc and attach the endpoint of a
      tangent line to one of the arc's endpoints you have fixed the free moving
      point (2 DOF) and the direction (1 DOF). This means that point/point tangency
      consumes 3 DOF.

\img{height=5.8cm}{TangentPointPoint1}
\hfill
\raisebox{2cm}{$\stackrel{\icon{Constraint_Tangent}}{\longrightarrow}$}
\hfill
\img{height=5.8cm}{TangentPointPoint2}

\item [Line to line] Assume one fixed line and a second line without any
      restrictions. If a tangency constraint is applied between the lines,
      they are made collinear, i.e. they now lie both on the same infinite
      line. This fixes both endpoints to lie on that line thus consuming 2
      DOF.

\img{width=0.35\textwidth}{TangentlineLine1}
\hfill
\raisebox{1cm}{$\stackrel{\icon{Constraint_Tangent}}{\longrightarrow}$}
\hfill
\img{width=0.35\textwidth}{TangentlineLine2}

\end{description}
            

\vbox{
\begin{Exercise}
Create a sketch for a flange of the following shape. Use the polyline tool for
the outer part, using the M key to toggle polyline mode. The small holes have
the same diameter (10\,mm). The outer arcs have the same centers as the small
holes.

\img{width=0.7\textwidth}{TangencyFlange}
\end{Exercise}}

There is a curve/curve tangency of the inner circle and one of the triangle's
lines, and the same kind of curve/curve tangency between the blue construction circle
and the outer upper straight line.

If you have closed the outer polyline while creating it, there is a
coincidence constraint created where you actually want to have point to point
tangency. To achieve this we have several possibilities:

\begin{itemize}
\item You select the coincidence using box selection and remove it before applying tangency.
\item You select the coincidence in the panels list of constraints and remove it before applying tangency.
\item If you have enabled automatic removal of redundant constraints, the
      coincidence will be removed automatically on creation of the point/point-tangency.
\item If automatic removal of redundant constraints is not enabled, you can
      nevertheless select the endpoints using box selection and apply tangency. The
      solver notices the redundancy and will complain with an appropriate message.
      By clicking on the active part of the message you can select and remove the
      coincidence.
\item Select the edges instead of the points and apply a curve/curve tangent
      constraint. The solver detects this and replaces the constraints
      appropriately.
\end{itemize}

Now that you know this you would of course have avoided this situation
alltogether by not connecting the last point when creating the outer edge.

For now you can either select the coincidence from the list or using box selection or
by simply clicking on the link in the solver message and delete it.

As promised in the section about perpendicular constraints, we can now
work through the following exercise

\begin{Exercise}
\label{ExercisePerpendicularArcs}
Construct two arcs which have a perpendicular intersection
\end{Exercise}

To do so:
\begin{itemize}
\item Create the arcs
\item Create a construction line with a point/line perpendicular
      constraint on one of the arcs and the endpoint of the line:

      \img{}{PerpendicularCurveCurve1}
\item Create a point/line tangent constraint on the other arc and the
      same endpoint of the line:

      \img{}{PerpendicularCurveCurve2}
\end{itemize}

\section{Equality}
\begin{tabular}{|l|l|}
\hline
Icon: & \icon{Constraint_EqualLength}\\
\hline
\dofConsumed & 1 \\
\hline
\end{tabular}

If you have a line with one of the endpoints fixed, you can move the other point
with its 2 DOF freely. If you fix the length of the line with an equality constraint
you reduce the DOF by one. Thus equality constraint consumes 1 DOF.

You can either apply equality to two lines or to two arcs or arc and circle.
Mixing line and arc is not possible. For arcs and circles the equality
constraint makes their radii (not edge length) equal.

{\newcommand{\width}{0.4\textwidth}
\img{width=\width}{Equality1}
\hspace{1em}
\raisebox{1cm}{$\stackrel{\icon{Constraint_EqualLength}}{\longrightarrow}$}
\hspace{1em}
\img{width=\width}{Equality2}

\img{width=\width}{EqualityArc1}
\hspace{1em}
\raisebox{1.5cm}{$\stackrel{\icon{Constraint_EqualLength}}{\longrightarrow}$}
\hspace{1em}
\img{width=\width}{EqualityArc2}

\img{width=\width}{EqualArcArcCircle1}
\hspace{1em}
\raisebox{1.5cm}{$\stackrel{\icon{Constraint_EqualLength}}{\longrightarrow}$}
\hspace{1em}
\img{width=\width}{EqualArcArcCircle2}
}

\section{Symmetry}
\label{symmetry}
\begin{tabular}{|l|l|}
\hline
Icon: & \icon{Constraint_Symmetric}\\
\hline
\dofConsumed & 2 \\
\hline
\end{tabular}

Making a point with its two DOF symmetric to a fixed point will remove both DOF;
thus the symmetry consumes 2 DOF.

\paragraph{Warning:} Symmetry is---from what I have seen---the constraint which
raises issues more often than other constraints. So read this section carefully
to avoid any problems. Some issues are not yet solved, they mostly occur in connection with symmetry
and arcs. DOF detection does not always show correct values.

Symmetry comes in two flavors, the point-point-point variant and the
point-line-point variant.

\begin{description}
\item [Point-point-point symmetry] This variant of symmetry arranges three
      points so that they lie on a (virtual) line and the outer points have
      equal distance to the point in the middle.

      To apply symmetry select first both outer points and finally the point
      in the middle. It is good advice to arrange the sketch \emph{before}
      applying symmetry so that all points are near their final position!

      The different geometric objects, line, arc, and point, in the following
      exercise are for demonstration purpose only, distinguishing which points
      are affected.
      \begin{Exercise}
      Create a sketch according to the following image and apply symmetry
      after selecting the points {\em lower end of the line} and {\em lower
      end of the arc} and the \emph{single point} in different orders, so that
      each of the points comes last once.
      
      \img{scale=0.8}{Symmetry0}
      \end{Exercise}

      Here are the three different solutions:
      \vspace{1ex}
      
      {\newcommand{\width}{0.37\textwidth}
      \begin{tabular}{l@{\ }l}
      \bf End of line last: &\vspace{1ex}\imgTop{width=\width}{SymmetryEndOfLine}\\
      \bf End of arc last:  &\vspace{1ex}\imgTop{width=\width}{SymmetryEndOfArc}\\
      \bf Single point last:&\imgTop{width=\width}{SymmetrySinglePoint}
      \end{tabular}}
      
      In the last case the center is hard to see, because the single point
      vanishes below the symmetry marks in the center.

\paragraph{Special case of point-point-point symmetry:}
If you want to fix a point in the middle of a line you can simply select the
line and the point and apply the symmetry constraint. The selection order doesn't
matter here:

\img{}{SymmetryLinePoint1} 
\hspace{2em}
\raisebox{1.6cm}{$\stackrel{\icon{Constraint_Symmetric}}{\longrightarrow}$}
\hspace{2em}
\img{}{SymmetryLinePoint2}

\item [Point-line-point symmetry] This variant of symmetry arranges two points
      so that they are mirrored at the line. In this case the sequence of the
      selection doesn't matter:

\img{}{SymmetryPointLinePoint1} 
\hspace{2em}
\raisebox{2cm}{$\stackrel{\icon{Constraint_Symmetric}}{\longrightarrow}$}
\hspace{2em}
\img{}{SymmetryPointLinePoint2}

\end{description}

\begin{Exercise}
Recreate the sketch from exercise \vref{exerciseSlot}. The slot has to be centered in
the surrounding rectangle.
\end{Exercise}

\paragraph{Hint:} Use an additional point (see section \vref{Point})
in the center of the rectangle and the slot.

\img{width=\textwidth}{slotCentered}


\vbox{
\paragraph{Warning:} If you create a rectangle or use autoconstraints which
automatically create horizontal or vertical constraints a common use case is
to apply later a symmetry constraint. In that case the horizontal/vertical
constraint is implied by the symmetry.
\vspace{1ex}

{\LARGE No:} {\imgTop{}{SymmetryRedundantNo}}

See the vertical constraints at the right and horizontal at the bottom? Delete them:
}

\vspace{1ex}
{\LARGE Maybe:}\hfill {\imgTop{}{SymmetryRedundantMaybe}}\hspace{2em}
\vspace{1ex}

Even better: Use one horizontal constraint, one vertical constraint, and apply a symmetry constraint between the lower left endpoint, the upper right endpoint, and the origin:

\vspace{1ex}
{\LARGE Yes:}\hfill {\imgTop{}{SymmetryRedundantYes}}\hspace{2em}

The two remaining DOF are the horizontal and the vertical length.

\subsubsection*{Things you should not do}
There are cases where symmetry can be applied, but it consumes only one
DOF. This happens often in connection with arcs, where additional implicit
constraints come into play.

There are two possibilities of what can happen - depending on some yet unknown condition:

\pagebreak[4]
\begin{itemize}
\item The solver shows 1 DOF after applying symmetry

\begin{tabular}{@{}c}
\img{scale=0.85}{SymmetryPatho1}\\
$\downarrow$ \ \raisebox{1ex}{\iconSmall{Constraint_Symmetric}}\\[2ex]
\img{scale=0.85}{SymmetryPatho2} 
\end{tabular}

This is surprising, because there are indeed two DOF: one for the radius of the
arc, and one for the vertical position or the distance of the ends. If one of
those is applied, the number of DOF remains at 1, which is correct. Yet the
number of constraints consumed doesn't match the sum of the DOF of the
constraints. 

\img{scale=0.8}{SymmetryPatho3}

If the horizontal constraint is removed again, the DOF are shown
correctly as 2.

\item After applying the symmetry constraint the solver shows 2 DOF

\begin{tabular}{@{}c}
\img{scale=0.84}{SymmetryPatho1}\\
$\downarrow$ \ \raisebox{1ex}{\iconSmall{Constraint_Symmetric}}\\[2ex]
\img{scale=0.84}{SymmetryPatho3}
\end{tabular}

which again can be seen as surprising, because it means that symmetry consumes
only one DOF.
\end{itemize}
In both cases the solver is smart and silently drops part of a constraint. It
doesn't show a redundancy warning, because none of the other constraints could
be removed without loosing DOF.

In many cases this works well, but I have seen quite some cases where it
caused problems. So I would strongly recommend to avoid such constraining. In
the example given here it would be better not to use symmetry at all, but e.g.
a horizontal constraint instead. This reduces the DOF as expected by 1:

\img{width=0.6\textwidth}{SymmetryPatho4}


\section{Block}
\begin{tabular}{|l|l|}
\hline
Icon: & \icon{Sketcher_ConstrainBlock}\\
\hline
\dofConsumed & 1 - arbitrary \\
\hline
\end{tabular}

The block constraint consumes all remaining DOF of a line or an arc, which can
be 1 e.\,g. for a partially constrained line, up to 5 for an arc without any other
constraint. For B-splines this number can be arbitrarily high.

The block constraint fixes both ends of a line, center and radius of a circle,
center and both endpoints of an arc in their current position\,/\,dimension.

You apply it to lines, circles and arcs, not to points. That means you cannot
select the whole sketch and fix everything, you have to select the lines and
curves.

\begin{Exercise}
Create a new Sketch and enter Sketcher. After that, create the following
Sketch from scratch with no more than 9 clicks from zero to being fully
constrained. In the image the constraints are hidden.

\img{}{BlockHidden}
\end{Exercise}

\subsubsection*{Solution:} 

\begin{tabular}{|l|l|}
\hline
{\bf clicks} & {\bf action}\\
\hline
1  & select Polyline tool\\
5  & create the closed shape, use the M key to change the continuation mode\\
1  & select block constraint\\
2  & select two opposite elements\\
\hline
\end{tabular}

\paragraph{Warning:}
The block constraint looks intriguing if you want to fully constrain a sketch,
but in most cases it is not advised to use it for common engineering tasks.
You should not use it simply because you are lazy. Here are some use cases
where the block constraint is sensible:

\begin{itemize}
\item You have traced an image with tens if not hundreds of points and want to
      fix them.
\item You have a complicated B-spline with many control points which are not
      related.
\item You want to move some points of your sketch and other things should not
      move yet. Then you apply some block constraints, move the elements,
      \emph{and remove the block constraints again.}
\end{itemize}

\section{Horizontal Distance}
\begin{tabular}{|l|l|}
\hline
Icon: & \icon{Constraint_HorizontalDistance}\\
\hline
\dofConsumed & 1 \\
\hline
\end{tabular}

The horizontal distance fixes a point in one direction, thus consuming 1 DOF.

The horizontal distance constraint can either fix the horizontal distance
between two points or it can fix the x-coordinate.

\begin{itemize}
\item Applied to two points it fixes the horizontal distance between the
      points, independent from their position in the plane:
      
\img{}{HDist1} 
\hspace{2em}
\raisebox{1cm}{$\stackrel{\icon{Constraint_HorizontalDistance}}{\longrightarrow}$}
\hspace{2em}
\img{}{HDist2}

      It is possible but in this case hardly sensible to set it to a negative value.
\item Applied to a line is the same as applying it to the endpoints of the
      line.
\item Applied to a single point it sets the x-coordinate to the origin. If the
      value is negative, the point is left of the origin. 

\img{}{HDist3} 
\hspace{2em}
\raisebox{2cm}{$\stackrel{\icon{Constraint_HorizontalDistance}}{\longrightarrow}$}
\hspace{2em}
\img{}{HDist4}
\end{itemize}

\subsection*{Avoid horizontal distances of zero length}
It is possible to align things vertically by applying a horizontal distance
of 0. Although there is no solver message warning you should avoid this. Use a vertical
constraint \icon{Constraint_Vertical} instead. For one it is recommended to
prefer geometric constraints, second it keeps your sketch cleaner without the measure.


\section{Vertical Distance}
\begin{tabular}{|l|l|}
\hline
Icon: & \icon{Constraint_VerticalDistance}\\
\hline
\dofConsumed & 1 \\
\hline
\end{tabular}

The vertical distance fixes a point in one direction, thus consuming 1 DOF.

Applied to a single point it fixes the vertical distance to the origin,
applied to two points it fixes the vertical distance between them.

Everything which has been said about the horizontal distance holds for the
vertical distance as well, if you exchange "horizontal" and "vertical".

\section{Lock}
\begin{tabular}{|l|l|}
\hline
Icon: & \icon{Sketcher_ConstrainLock}\\
\hline
\dofConsumed & 2 per point\\
\hline
\end{tabular}

The lock constraint creates a horizontal and a vertical distance constraint
for each point involved which sums up to 2 DOF per point.

It is a shortcut to create horizontal and a vertical constraints without user
interaction. Like the block constraint it can be intriguing to use this in
order to arrive faster at a fully constrained sketch, but you should avoid
this and apply as many geometric constraints as possible before.

It can be sensible to use the lock constraint if you have created the sketch
with grid snap enabled (see section \vref{GridSnap}) and you want to fix the points
exactly in these positions.

The lock constraint is applied to a selection of points. Depending on the
number of selected points the behaviour is slightly different:

\begin{description}
\item [One point selected] The lock constraint creates a horizontal and
      a vertical distance constraint to the origin.
\item [Two points selected] A horizontal and a vertical distance constraint
      between these two points is created. (This is in fact a special variant of
      the following case.)
\item [Three or more points selected] A horizontal and a vertical distance constraint
      between each of these points and the last point is created.

      The behaviour is as if you had created all of these lock constraints
      separately, which you can see if you use the undo function.
\end{description}

\section{Length}
\begin{tabular}{|l|l|}
\hline
Icon: & \icon{Constraint_Length}\\
\hline
\dofConsumed & 1 \\
\hline
\end{tabular}

Consider a line with one point fixed, it has two DOF remaining. Applying a length
constraint reduces this to 1 DOF (which can be consumed by a horizontal \emph{or} vertical distance). Thus the length constraint consumes 1 DOF.

The length constraint comes in three different variants, two of them being
rather similar
\begin{description}
\item [Line Length.] It can fix the length of a line, as we have seen in
      section \ref{LineLength} \vpageref{LineLength}.
\vspace{-0.5ex}

\img{scale=1}{LengthLine1} 
\hspace{2em}
\raisebox{1cm}{$\stackrel{\icon{Constraint_Length}}{\longrightarrow}$}
\hspace{2em}
\img{scale=1}{LengthLine2}
\pagebreak[3]
\vspace{-1.5ex}
\item [Distance between points.] Select two arbitrary points and fix the
      distance between them:

\img{scale=1}{LengthPointPoint1} 
\hspace{2em}
\raisebox{1cm}{$\stackrel{\icon{Constraint_Length}}{\longrightarrow}$}
\hspace{2em}
\img{scale=1}{LengthPointPoint2}

\item [Distance from point to line.] If you select a line and a point, this
      constraint fixes the orthogonal distance between line and point, i.\,e. the distance between
      the point and its projection on the line. Thus it fixes the minimal distance between line and
      point. As we have seen before, the projection point can lie on the infinite
      prolongation of the line.

\img{}{LengthLinePoint1} 
\hspace{2em}
\raisebox{1cm}{$\stackrel{\icon{Constraint_Length}}{\longrightarrow}$}
\hspace{2em}
\img{}{LengthLinePoint2}
\end{description}

{\bf Warning:} As mentioned in the section \vref{LineLength} about
lines you should not use this constraint for horizontal or vertical
lines---unless you intend to change the angle of the element in Sketcher
later (for an example of this consider turning a slot as in section
\vref{SlotTilted}).

Use the specialized constraints horizontal distance or vertical
distance instead. That makes it easier for the solver to find a
solution; see section \vref{SolverRecommendations} for details.

\section{Radius and Diameter}
\begin{tabular}{|l|l|}
\hline
Icons: & \icon{Constraint_Radius}\\
       & \icon{Constraint_Diameter}\\
\hline
\dofConsumed & 1 \\
\hline
\end{tabular}

The radius or diameter constraint fixes one of the three DOF of a circle. (Two
remain for the position of the center.)

Application is straight forward: select a circle in the Sketch and apply the radius
constraint where you can input the value. If you want to use diameters in your sketch instead of radius,
open the icon drop down menu and select the diameter. It will stay in that
mode until you switch it back or quit and restart FreeCAD.

\section{Angle}
\label{Angle}
\begin{tabular}{|l|l|}
\hline
Icon: & \icon{Constraint_InternalAngle}\\
\hline
\dofConsumed & 1 \\
\hline
\end{tabular}

Like vertical or horizontal constraints the angle fixes the orientation of a
line in the plane and consumes 1 DOF.

After creating a line segment, whichever of the two endpoints was created
first is usually irrevelant.  However, it makes a difference here because
applying the angle constraint on two lines that appear identical will result
in two different angles depending on which endpoint of a particular line
segment was created first.  When applying an angle constraint, the two lines
are treated as if they are rays.

There are different modes for this constraint:

\begin{description}
\item [Single Line mode.] Select a line and apply the angle constraint. This
      fixes the angle between the line and the X-axis.
      
      While it is usually irrelevant in which way you create a line, here it
      is: for two seemingly identical lines you can get different angles.

\begin{Exercise}
Create two approximately parallel lines, one from lower left to upper right
and another vice versa from upper right to lower left.

Select the first line and apply an angle constraint.

Select the second line and apply an angle constraint.

\img{}{AngleXAxis}
\end{Exercise}
      
\item [Line-Line mode.] The most frequently used variant is to select two lines
      and define with the angle constraint the angle between them.
      
      Again it depends on the orientation of the angle where it is actually
      applied:

\img{}{AngleLineLine}

\item [Line-Point-Line mode.]
      If you select two lines and an additional point before applying an
      angle constraint, this point will become the vertex of the angle and the
      lines are the rays. To achieve this one or two point-on-object constraints are
      generated in addition to the angle between the lines. This assures that the
      vertex lies in fact on both lines.
\begin{Exercise}
Create a sketch with two lines and a point according to the following image.


Select both lines and the point and apply an angle constraint with an angle of
30\degree

\img{}{AngleLinePointLine1}
\hspace{2em}
\raisebox{1cm}{$\stackrel{\icon{Constraint_InternalAngle}}{\longrightarrow}$}
\hspace{2em}
\img{}{AngleLinePointLine2}
\end{Exercise}

{\bf Warning:} Applying this constraint consumes usually 3 DOF, one for the
angle and two for the point-on-object constraints. If one of the points
happens to be the endpoint of one of the lines, only 2 DOF are consumed.

\item [Single Arc mode]
If you select only an arc line and apply an angle constraint, the angle
between one endpoint of the arc, the center and the other endpoint is fixed. For a given
radius this fixes the arc length. The following exercise creates a 3/4 circle:

\begin{Exercise}
      Create an arc. Select it and apply an angle of 270\degree{}.

\hspace*{-0.5em}%
\raisebox{2cm}{\img{}{singleArc1}}
\hspace{2em}
\raisebox{3cm}{$\stackrel{\icon{Constraint_InternalAngle}}{\longrightarrow}$}
\hspace{2em}
\img{}{singleArc2}
\end{Exercise}

{\bf Remark on arc length:}\label{arclength} This kind of angle constraint can be used to calculate the
length of the arc in an expression: given the radius $r$ and the angle
$\alpha$ the length of the arc line $l$ is given by 

\[l = 2*\pi*r*\frac{\alpha}{360\degree}
\]

or vice versa if $l$ is given you can set the angle to yield the same length
for the arc by 

\[ \alpha = \frac {l * 360\degree}{2 \pi r}
\]

\item [Arc-Arc mode.] Similar to Line-Point-Line mode  you can combine two
      arcs and a point or an arc, a line, and a point. This means that
      Line-Point-Line mode can be viewed as a special form of this more
      general mode.

\begin{Exercise}
Create a sketch with two arcs which are connected with a coincidence
constraint. Let the arcs cross at an angle of 60\degree. In the following image
the vertex of the angle is an endpoint of one of the arcs.

\hspace*{-0.1\leftmargini}
\img{}{AngleCurveCurve1}
\hfill
\raisebox{1cm}{$\stackrel{\icon{Constraint_InternalAngle}}{\longrightarrow}$}
\hfill
\img{}{AngleCurveCurve2}
\end{Exercise}

{\bf Warning:} Applying this constraint can consumes 1, 2 or 3 DOF, because
additional constraints can be created. It consumes 1 DOF for the angle if the
arcs are already connected by a coincidence constraint. No additional
constraint is created.

It consumes 2 DOF by creating an additional point-on-object constraint, if
they are not connected but the point selected is one of the endpoints of the
arc.

It consumes 3 DOF by creating two additional point-on-object constraints, if
the point selected is none of the endpoints of the arcs.

% If you create a sketch where a line intersects an arc at a defined angle you
% first have to create a point on the circle.
\end{description}

\subsubsection*{Dos and Don'ts with Angles}
\begin{itemize}
\item Don't use angles with multiples of 90\degree; use geometric constraints
      instead.
      \begin{itemize}
      \item For an angle of 90\degree{} or 270\degree{} use the perpendicular constraint.
      \item For an angle of 180\degree{} use the tangent constraint.
      \end{itemize}
\item However, if you have a flipping sketch as shown in section \vref{Flip}
      you can improve robustness, due to the fact that the angle constraint
      respects the direction of the lines as if they are rays.
\end{itemize}

\section{Further Dos and Don'ts with Constraints}
\label{SolverRecommendations}
Now that you know about the different constraints, you should not only aim at
fully constrained sketches, you should create good fully constrained sketches. Some advice
was already given for some of the constraints above, here are some additional recommendations.

%https://www.freecadweb.org/tracker/view.php?id=1223
The following recommendations are based on recommendations given by the developer who first
coded Sketcher workbench (FreeCAD forum user logari81) and other power users.

There are several things to consider. There is what I would like to call the
external or user's view: Is the sketch easy to understand and easy to maintain? To achieve this it
is recommended to prefer geometric constraints over measures with numerical
values; the latter crowding the view and making the sketch less flexible. This applies
especially to dimensions of length 0. They should always be replaced by geometric constraints.

The other side to consider is the internal view: Which constraints are
friendly to the solver, i.\,e. which lead to reliable solutions.The solver
does not solve its internal equation system algebraically, but numerically.
That means a sketch is fully constrained if the deviations are very very
small. Nevertheless there are rounding errors due to the finite precision, and
in rare cases these can lead to difficulties in later modelling steps.
 
\subsubsection*{Preferred constraints}
\begin{itemize}
\item Coincidence
\item Horizontal and vertical constraint.
\item Point to Point tangency.
\item Point on line
\item Horizontal and vertical length.
\end{itemize}

\subsubsection*{Constraints for subordinate use}
It is by no way wrong to use these constraints. But you should not use them, if
you can use one of the preferred constraints instead.
\begin{itemize}
\item Length
\item Edge/Edge Tangency
\item Symmetry 
\end{itemize}

\subsubsection*{Don't make your sketch too complicated!}
Instead of putting everything possible into one sketch, you should consider to split it into
several sketches. As an example take a sketch with some holes and cutouts and a complicated
outline, which you want to pad. Instead of modeling all in one sketch you can model
the outline in the first sketch, pad it, model the cutouts in another sketch and
make a pocket.

As a rule of thumb it is recommended (thanks Normand!) to use not more than 100 constraints in
a sketch to keep solver time at a reasonable level.

\section{Driven dimensions}
Sometimes it is interesting to see the value of a certain distance or an angle
without \emph{setting} it. For this purpose you can use driven dimensions.
This can be more than just interesting if you want to use such values in an
expression outside of the sketch.

\begin{Exercise}
We will show how to get the square root of 2, which is known to be the
diagonal length of a square with side length 1.
\end{Exercise}

\begin{itemize}
\item Draw a square with side length 1.
      
      \img{scale=0.5}{driven1}
\item Select diagonal points and start as if you want to create a length
      dimension. The sketch was fully constrained, so the solver shows an
      error message. But if you check the Reference box, the error will vanish
      and the dimension will be shown in blue instead of red.

      \img{scale=0.5}{driven2}

      Confirm and you will permanently see the length of the diagonal even if you change
      the length of the sides.
\end{itemize}

There are three ways to create a driven dimension:
\begin{itemize}
\item You can do it in the way described in the previous exercise.
\item You can select an existing dimension and click the toggle
      \icon{Sketcher_ToggleConstraint}. This can also be used if you want to switch
      from a driven constraint to a real ("driving") constraint.
\item Without having anything selected click the same toggle icon
      \icon{Sketcher_ToggleConstraint}. The dimensional constraints icons will
      turn blue
      \img{}{drivenAllBlue} and all dimensions created in this mode will be driven constraints.
\end{itemize}

\vbox{It is well known that the angle between two adjacent lines in a square
is 90\degree{}. But how about a pentagon?
\begin{Exercise}
Create a regular pentagon with an outer radius of 10. Find the angle between two
adjacent edges and find the radius of the incircle.

\img{scale=0.75}{drivenPentagon}
\end{Exercise}}

\paragraph{Solution:} The angle is 108\degree{} and the radius of the incircle is
approximately 8.090\degree.

\section{External Geometry}
\begin{tabular}{|l|l|}
\hline
Icon: & \icon{Sketcher_External} \\
\hline
\dofAdded & 0 \\
\hline
\end{tabular}

External geometry reuses geometry defined elsewhere thus adding no DOF to a sketch.

On the one hand external geometry can reference elements of other objects, such as
edges or vertices. I don't recommend newcomers to use this kind of external
geometry, because the resulting models are fragile concerning topological naming
issues.\\
On the other hand external geometry reuses elements from previously defined
sketches. This is what we will use here.

\vbox{
\begin{Exercise}
Given a block of the shape below we want to cut a strip off at two ends of one of
the sides.
\end{Exercise}

\img{width=0.4\textwidth}{ExternalBlock}\hfill \raisebox{2cm}{$\longrightarrow$} \hfill \img{width=0.4\textwidth}{ExternalBlockTarget}
}

\begin{itemize}
\item Preparations: Create a block as shown in the left image. Place it so that the
      face in front lies in one of the principal planes.

      I have placed the sketch of mine in the XZ plane and have checked the
      "Reverse" box of the pad.

      \img{scale=0.5}{ExternalBlockSketch}
\item Create a new sketch in the same plane as the front of the block.
\item Don't close the still empty sketch. In the Combo view switch from Task tab to
      Model tab, in order to view the history tree.
\item Make the pad invisible and the sketch visible, the tree should look like this:\\
      \img{}{ExternalBlockTree}

      The sketch named "SketchBlock" in the above picture is used to create
       the Pad named "PadBlock". The sketch we actually are still editing is
       Sketch009. In your model it will probably be named Sketch001.
\item Switch back from Model tab to Tasks tab, now showing the well known Sketcher panel
      again.
\item In 3D view you can see the SketchBlock's sketch. The lines are slighly
      thinner than those in the current sketch, you cannot change the
      SketchBlock geometry.
\item Select the external geometry tool \icon{Sketcher_External}.
\item Select the upper line, it will turn magenta.\\[1ex]
      \img{scale=0.8}{ExternalSelect}\\
      You could now directly select more elements, which is not necessary here.
      Instead of selecting the line, you could have selected the endpoints only.
\item Model the strips. Please note, that the strips cover more than they have to
      remove.\\[1ex]
\img{scale=0.85}{ExternalFinalSketch}

      \begin{itemize}
      \item Both strips have the same width of 5\,mm.
      \item The right side of the right strip is fixed with the point-on-object constraint
            using the endpoint of the external geometry.
      \item The bottom line of the right strip is fixed by a point-on-object constraint
            on the X-axis.
      \item The left upper line is horizontal
      \item both upper lines line are aligned with a tangency constraint.
      \end{itemize}
\item Close the Sketcher and apply the pocket with a depth of 5\,mm.
\end{itemize}

\subsubsection*{Identification of external geometry}
The list of elements as described in section \ref{ListOfElements1} \vpagerefrange{ListOfElements1}{ListOfElements2} 
contains all geometric elements, including external geometry. These external
geometry elements are always last in the list. The dots at the end of the
icons in the list have magenta color -- the same color as used for the
external elements in 3D view. In the image you see that the last three
elements are references to external geometry: a line, an arc, and another line.

\img{scale=0.8}{ExternalListOfElements}


Below the list you can check "Extended
Naming", which names the elements bein external and shows where they are linked to.

\img{scale=0.8}{ExternalListOfElementsExtended}

\newpage
\part{Creating Objects Based on Sketches}
% from Bejant Eventually, in your Sketch you will want to end up with an enclosed perimeter of white geometry where no edges cross one another, and have only two white edges at any one vertex, and no remaining DOF (which means the Sketch has become "Fully Constrained"). When a Sketch becomes Fully Constrained, the formerly white geometry turns green in Sketcher.


To be written

\section{Sketches for Pads and Pockets}
\section{Use Symmetry!}
\section{Placement and AttachmentOffset}
\label{SketchPlacement}

\section{Validate sketches}
\label{ValidateSketch}
\newpage
\begin{appendix}
\section*{DOF overview}
\begin{tabular}[t]{|l|l|c|}
\multicolumn{3}{c}{\large\bf Elements} \\[2ex]
\hline
Element        & Icon                                 & DOF \\
               &                                      & added\\
\hline
Line           & \iconMedium{Sketcher_CreateLine}           & 4\\[8pt]
\hline
Circle         & \iconMedium{Sketcher_CreateCircle}         & 3 \\[8pt]
\hline
Arc            & \iconMedium{Sketcher_CreateArc}            & 5 \\[8pt]
\hline
Polyline       & \iconMedium{Sketcher_CreatePolyline}       & - \\[8pt]
\hline
Rectangle      & \iconMedium{Sketcher_CreateRectangle}      & 4\\[8pt]
\hline
Triangle       & \iconMedium{Sketcher_CreateTriangle}       & 4 \\[8pt]
\hline
Square         & \iconMedium{Sketcher_CreateSquare}         & 4 \\[8pt]
\hline
Pentagon       & \iconMedium{Sketcher_CreatePentagon}       & 4 \\[8pt]
\hline
Hexagon        & \iconMedium{Sketcher_CreateHexagon}        & 4 \\[8pt]
\hline
Heptagon       & \iconMedium{Sketcher_CreateHeptagon}       & 4 \\[8pt]
\hline
Octagon        & \iconMedium{Sketcher_CreateOctagon}        & 4 \\[8pt]
\hline
RegularPolygon & \iconMedium{Sketcher_CreateRegularPolygon} & 4 \\[8pt]
\hline
Slot           & \iconMedium{Sketcher_CreateSlot}           & 4 \\[8pt]
\hline
Point          & \iconMedium{Sketcher_CreatePoint}          & 2 \\[8pt]
\hline
B-spline open  & \iconMedium{Sketcher_CreateBSpline}          & 3*$N$ \\
B-spline closed& \iconMedium{Sketcher_Create_Periodic_BSpline}& 3*$N$ \\
\hline
\end{tabular}
\hfill
\newcommand{\raisedIconSmall}[1]{\raisebox{5pt}{\iconSmall{#1}}}
\begin{tabular}[t]{|l|l|c|}
\multicolumn{3}{c}{\large\bf Constraints} \\[2ex]
\hline
Constraint                & Icon                                  & DOF \\
                          &                                       & consumed\\
\hline
Coincidence               & \raisedIconSmall{Constraint_PointOnPoint}        & 2 \\
\hline
PointOnObject             & \iconSmall{Constraint_PointOnObject}       & 1 \\
\hline
Vertical                  & \iconSmall{Constraint_Vertical}            & 1 \\
\hline
Horizontal                & \iconSmall{Constraint_Horizontal}          & 1 \\
\hline
Parallel                  & \iconSmall{Constraint_Parallel}            & 1 \\
\hline
Perpendicular line/line   & \iconSmall{Constraint_Perpendicular}       & 1 \\[-1ex]
Perpendicular point/line  &                                       & 2 \\
Perpendicular point/point &                                       & 3 \\
\hline
Tangent (curve/curve)     & \iconSmall{Constraint_Tangent}             & 1 \\[-1ex]
Tangent (point/curve,line/line)     &                                       & 2 \\
Tangent (point/point)     &                                       & 3 \\
\hline
Equality                  & \iconSmall{Constraint_EqualLength}         & 1 \\
\hline
Symmetry                  & \iconSmall{Constraint_Symmetric}           & 2 \\
\hline
Block                     & \iconSmall{Sketcher_ConstrainBlock}        & 1-arbitrary \\
\hline
Lock                      & \iconSmall{Sketcher_ConstrainLock}         & 2 per point\\
\hline
Horizontal Distance       & \iconSmall{Constraint_HorizontalDistance}  & 1 \\
\hline
Vertical Distance         & \iconSmall{Constraint_VerticalDistance}    & 1 \\
\hline
Length                    & \iconSmall{Constraint_Length}              & 1 \\
\hline
Radius                    & \iconSmall{Constraint_Radius}              & 1 \\
\hline
Diameter                  & \iconSmall{Constraint_Diameter}            & 1 \\
\hline
Angle                     & \iconSmall{Constraint_InternalAngle}       & 1 \\
\hline
\end{tabular}
\end{appendix}

\end{document}


introduction according to bejant


unknown icons in sketcher yellow magnet, yellow or green H

Delete performs a recompute

Validate Sketch

hide constraints


Merks"atze:
\item Watch the solver messages on every constraint you add
\item In case of an error message remove the last constraint

reference geometry

applying constraints: create points way off their final position. 

Conicals and BOPCheck change the wiki


better color for triangles ConicalTangent and ConicalPerpendicular

french version layout:
http://packages.oth-regensburg.de/ctan/macros/latex/contrib/babel-contrib/frenchb/frenchb.pdf
https://www.typografie.info/3/topic/21014-franz%C3%B6sische-typographie/page/2/

colors: 107 114 163
        166 173 196
     -> 136 143 180

\img{scale=0.95,clip,trim=0 20 0 0}{ArcExercise}
